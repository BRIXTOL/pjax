/**
* SPX ~ Single Page XHR | https://spx.js.org
*
* @license CC BY-NC-ND 4.0
* @version 0.1.2-beta.1
* @copyright 2024 Nikolas Savvidis
*/
var vo=Object.defineProperty,Yr=Object.defineProperties;var zr=Object.getOwnPropertyDescriptors;var Eo=Object.getOwnPropertySymbols;var Gr=Object.prototype.hasOwnProperty,_r=Object.prototype.propertyIsEnumerable;var xo=(e,t,o)=>t in e?vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,To=(e,t)=>{for(var o in t||(t={}))Gr.call(t,o)&&xo(e,o,t[o]);if(Eo)for(var o of Eo(t))_r.call(t,o)&&xo(e,o,t[o]);return e},bo=(e,t)=>Yr(e,zr(t));var Kr=(e,t)=>{for(var o in t)vo(e,o,{get:t[o],enumerable:!0});};var q=typeof window!="undefined"?window:{screen:{},navigator:{}},ue=(q.matchMedia||function(){return {matches:!1}}).bind(q),Zr={get passive(){return !0}},Ao=function(){};q.addEventListener&&q.addEventListener("p",Ao,Zr);q.removeEventListener&&q.removeEventListener("p",Ao,!1);var Ht="ontouchstart"in q,Qr="TouchEvent"in q,qt=Ht||Qr&&ue("(any-pointer: coarse)").matches,No=(q.navigator.maxTouchPoints||0)>0||qt,$o=q.navigator.userAgent||"",en=ue("(pointer: coarse)").matches&&/iPad|Macintosh/.test($o)&&Math.min(q.screen.width||0,q.screen.height||0)>=768,tn=(ue("(pointer: coarse)").matches||!ue("(pointer: fine)").matches&&Ht)&&!/Windows.*Firefox/.test($o),on=ue("(any-pointer: fine)").matches||ue("(any-hover: hover)").matches||en||!Ht,Ae=No&&(on||!tn)?"hybrid":No?"touchOnly":"mouseOnly";var It=typeof window!="undefined";"content"in document.createElement("template");document.createRange&&"createContextualFragment"in document.createRange();var R=qt?"pointer":"mouse",re=window.location.origin,Lo=Object.create,T="",{warn:kt,info:Ro,error:Dt,debug:ss}=console,Oo=()=>document.documentElement,b=()=>document.body,Co=()=>document.head,u=e=>e?Object.assign(Lo(null),e):Lo(null),I=e=>new Set(e),Mo=e=>new Proxy(u(),e),S=()=>new Map;var h=class extends XMLHttpRequest{constructor(){super(...arguments);this.key=null;}};h.n=S(),h.m=S(),h.s={};var s={index:"",eval:!0,patched:!1,loaded:!1,logLevel:2,qs:u(),config:{fragments:["body"],timeout:3e4,globalThis:!0,schema:"spx-",logLevel:3,cache:!0,components:null,maxCache:100,reverse:!0,preload:null,annotate:!1,eval:{script:null,style:null,link:null,meta:!1},hover:{trigger:"href",threshold:250},intersect:{rootMargin:"0px 0px 0px 0px",threshold:0},proximity:{distance:75,threshold:250,throttle:500},progress:{bgColor:"#111",barHeight:"3px",minimum:.08,easing:"linear",speed:200,threshold:500,trickle:!0,trickleSpeed:200}},fragments:S(),components:{f:I(),t:S(),i:S(),o:Mo({get:(e,t)=>s.components.i.get(e[t])})},events:u(),observe:u(),memory:u(),pages:u(),snaps:u(),resources:I()};var $e="SPX ",Po="\x1B[",So="\x1B[0m";var wo=e=>Po+"31m"+e+So;var Ho=e=>Po+"36m"+e+So,m=(e,t,o)=>{let r=s.logLevel;if(!(r>2&&e<=2)){if(Array.isArray(t)&&(t=t.join(" ")),(e===2||e===1)&&(r===1||r===2))Ro(`${$e}%c${t}`,`color: ${o||"#999"};`);else if(e===3&&r<=3)o?kt($e+t,o):kt($e+t);else if(e===5||e===4){o?Dt($e+t,o):Dt($e+t);try{throw e===4?new TypeError(t):new Error(t)}catch(n){}}}};var qo=/&(?:amp|lt|gt|quot|#39|#x2F|#x60|#x3D);/g,Io=/^[A-Z]|[_-]/;var ko=/\b(?:append|prepend)/,Do=/\s+/g,Le=/^\b(?:true|false)$/i,Ke=/^\d*\.?\d+$/,Re=/^(?:[.-]?\d*\.?\d+|NaN)$/;var Wo=/\b(?:intersect|hover|proximity)\b/;var Uo=/\b(?:SCRIPT|STYLE|LINK)\b/,Fo=/\[(['"]?.*['"]?,?)\]/,Wt=/[xy]\s*|\d*\.?\d+/gi;var Oe=I(),Vo={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&#x60;":"`","&#x3D;":"="};function O(e,t){if(arguments.length===1)return i=>O(e,i);let o=t.length;if(o===0)return;let r,n=-1;for(;++n<o&&(r=e(t[n],n,t),r!==!1););return r}var jo=e=>{let t=e.replace(/\s+,/g,",").replace(/,\s+/g,",").replace(/['"]/g,"");return t.charCodeAt(0)===91&&(/^\[\s*\[/.test(t)||/,/.test(t)&&/\]$/.test(t))&&(t=t.replace(/^\[/,"").replace(/\]$/,"")),t.split(/,|\|/)},de=(e,t)=>{try{let o=(t||e).replace(/\\'|'/g,r=>r[0]==="\\"?r:'"').replace(/"(?:\\.|[^"])*"/g,r=>r.replace(/\n/g,"\\n")).replace(/\[|[^[\]]*|\]/g,r=>/[[\]]/.test(r)?r:r.split(",").map(n=>n.replace(/^(\w+)$/,'"$1"').replace(/^"([\d.]+)"$/g,"$1")).join(",")).replace(/([a-zA-Z0-9_-]+)\s*:/g,'"$1":').replace(/:\s*([$\w-]+)\s*([,\]}])/g,':"$1"$2').replace(/,(\s*[\]}])/g,"$1").replace(/([a-zA-Z_-]+)\s*,/g,'"$1",').replace(/([\]},\s]+)?"(true|false)"([\s,{}\]]+)/g,"$1$2$3");return JSON.parse(o)}catch(o){return m(5,"Invalid JSON in attribute value: "+JSON.stringify(e||t,null,2),o),t}},Ce=e=>e[e.length-1],Bo=e=>e.replace(/\s+/g," ").trim(),Xo=e=>e.replace(/\./g,"\\.").replace(/@/g,"\\@").replace(/:/g,"\\:"),Yo=()=>new Promise(e=>setTimeout(()=>e(),1)),U=(e,t=1,o)=>setTimeout(()=>e(),t),Ze=()=>Promise.resolve();var Ut=e=>{switch(e.nodeName){case"SCRIPT":return e.matches(s.qs.x);case"STYLE":return e.matches(s.qs.x);case"META":return e.matches(s.qs.N);case"LINK":return e.matches(s.qs.A);default:return e.getAttribute(s.qs.L)!=="false"}};var sn=e=>e.replace(qo,t=>Vo[t]||t),Qe=()=>new Date().getTime(),et=e=>{let t=typeof e=="object";return o=>t&&o?typeof o=="string"?o in e:o.every(r=>r?r in e:!1):!1},w=(e,t)=>typeof e=="object"?t in e:!1,Ft=(e,t)=>{switch(e){case String:return t||"";case Boolean:return t==="true"||!1;case Number:return Number(t)||0;case Object:return typeof t=="object"?t:{};case Array:return Array.isArray(t)?t:[];default:return t}},F=(e,t,o,r=null)=>r!==null?t in e?e:Object.defineProperty(e,t,{get:()=>o,configurable:r}):Object.defineProperty(e,t,{get:()=>o}),tt=(e,t)=>O(([o,r])=>Object.defineProperty(e,o,{get:r}),t),Vt=e=>"target"in e?e.target.length===1&&e.target[0]==="body"?e.target:e.target.includes("body")?(m(3,`The body selector passed via ${s.qs.d} will override`),["body"]):e.target.filter((t,o,r)=>t!==""&&t.indexOf(",")===-1?r.indexOf(t)===o:!1):s.config.fragments.length===1&&s.config.fragments[0]==="body"?["body"]:[],Me=e=>e.length===1&&e[0]==="body"?"body":e.length===0?null:e.join(","),ot=e=>{let t=typeof e;if(t==="object"){for(let o in e)return !1;return !0}return t==="string"?e[0]===void 0:Array.isArray(e)?e.length>0:null};var jt=(e=Math.floor(Math.random()*89999+1e4))=>Oe.has(e)?jt():(Oe.add(e),e),z=function e(t=5){let o=Math.random().toString(36).slice(-t);return Oe.has(o)?e(t):(Oe.add(o),o)};var zo=(e=2)=>(t,o)=>{let r=t.length;return (r<1||t[r-1].length===e?t.push([o]):t[r-1].push(o))&&t},Go=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":e<1073741824?(e/1048576).toFixed(1)+" MB":(e/1073741824).toFixed(1)+" GB",Bt=e=>e[0].toLowerCase()+e.slice(1),rt=e=>e[0].toUpperCase()+e.slice(1),Xt=e=>/[A-Z]/.test(e)?e.replace(/(.{1})([A-Z])/g,"$1-$2").toLowerCase():e,B=e=>/[_-]/.test(Bt(e))?e.replace(/([_-]+).{1}/g,(t,o)=>t[o.length].toUpperCase()):e,_o=e=>I([].slice.call(e)),V=(e,t)=>{let o=typeof e=="string"?b().querySelectorAll(e):e,r=o.length;if(r===0)return;let n=-1;for(;++n<r&&t(o[n],n)!==!1;);},Yt=e=>{for(let t in e)delete e[t];},ne=e=>new DOMParser().parseFromString(e,"text/html"),se=e=>(e||document).documentElement.outerHTML,zt=e=>{let t=e.indexOf("<title");if(t===-1||e.slice(0,t).indexOf("<svg")>-1)return T;let o=e.indexOf(">",t)+1,r=e.indexOf("</title",o);return r===-1?T:sn(e.slice(o,r).trim())},Ko=(e,t)=>t.querySelector(e),Jo=(e,t)=>[].slice.call(t.querySelectorAll(e))||[],nt=(e=>{let t=r=>new Promise(n=>n(r())),o=async(r=2,n=200)=>{for(;e.length>0;){for(let i of e.splice(0,r))await t(i);await new Promise(i=>setTimeout(i,n));}};return (...r)=>{r.forEach(n=>e.push(n)),U(()=>o(),50);}})([]);var Zo=()=>{if(s.patched)return;s.patched=!0;let e=Element.prototype.setAttribute,t=document.createElement("i");Element.prototype.setAttribute=function(r,n){if(r.indexOf("@")<0)return e.call(this,r,n);t.innerHTML=`<i ${r}="${n}"></i>`;let i=t.firstElementChild.getAttributeNode(r);t.firstElementChild.removeAttributeNode(i),this.setAttributeNode(i);};};var ie=(()=>{let e=[],t=document.createElement("div"),o=null,r,n=null,i=({bgColor:g,barHeight:Ne,speed:pe,easing:Xr})=>{t.style.cssText=`pointer-events:none;background:${g};height:${Ne};position:fixed;display:block;z-index:2147483647;top:0;left:0;width:100%;will-change:opacity,transform;transition:${pe}ms ${Xr};`;},a=g=>(-1+g)*100,c=(g,Ne,pe)=>Math.max(Ne,Math.min(pe,g)),l=()=>n||(t.style.transform=`translateX(${a(o||0)}%)`,n=b().appendChild(t),t),f=()=>{let g=b();g.contains(n)?n.animate({opacity:["1","0"]},{easing:"ease-out",duration:100}).onfinish=()=>{g.removeChild(n),n=null;}:n=null;},p=()=>{let g=e.shift();g&&g(p);},y=g=>{e.push(g),e.length===1&&p();},d=g=>{g=c(g,s.config.progress.minimum,1),o=g===1?null:g;let Ne=l();y(pe=>{Ne.style.transform=`translateX(${a(g)}%)`,setTimeout(()=>(g===1&&f(),pe()),s.config.progress.speed*(g===1?2:1));});},be=g=>{if(!o)return ze();o<1&&(g||(g=o<.2?.1:o<.5?.04:o<.8?.02:.005),d(c(o+g,0,.994)));},Ye=()=>setTimeout(()=>o&&(be(),Ye()),s.config.progress.trickleSpeed),ze=g=>{s.config.progress&&(r=setTimeout(()=>{o||d(0),s.config.progress.trickle&&Ye();},g||0));};return {start:ze,done:g=>{clearTimeout(r),!(!g&&!o)&&(be(.3+.5*Math.random()),d(1));},style:i}})();var st=(e,t)=>{if(e.define.name!=="")return e.define.name;let o=e.name,r=t,n="define"in e&&"name"in e.define;return console.log(e.name,t),e.define.name=Bt(t||o),t!==e.define.name&&(t=B(e.define.name)),n&&o!==r&&Io.test(e.define.name)&&m(3,[`Component identifer id "${e.define.name}" must use camelCase format.`,`The identifer has been converted to "${t}"`]),t},G=(e,t=!1)=>{let{t:o}=s.components;for(let r in e){let n=e[r],i=t?r:st(n,r);o.has(i)||(o.set(i,n),m(1,`Component ${n.name} registered using id: ${i}`,"#F48FB1"));}s.config.components||(s.config.components=!0);};function C(e,...t){let o=e==="before:cache";o&&(t[1]=ne(t[1]));let r=!0;return O(n=>{let i=n.apply(null,t);o?i instanceof Document?r=i.documentElement.outerHTML:typeof r!="string"&&(r=i!==!1):r=i!==!1;},s.events[e]||[]),r}var Qo=(e,t,o)=>(e in s.events||(s.events[e]=[]),s.events[e].push(o?t.bind(o):t)-1),er=(e,t)=>{if(e in s.events){let o=s.events[e];if(o&&typeof t=="number")o.splice(t,1),m(2,`Removed ${e} event listener (id: ${t})`),o.length===0&&delete s.events[e];else {let r=[];if(o&&t)for(let n=0,i=o.length;n<i;n++)o[n]!==t?r.push(o[n]):e!=="x"&&m(2,`Removed ${e} event listener (id: ${n})`);r.length?s.events[e]=r:delete s.events[e];}}else m(3,`There are no ${e} event listeners`);};var Gt=(e,t)=>{let o=t(e);if(o===!1)return;o===1&&(e=e.nextSibling);let r,n;for(e.firstElementChild&&(n=0,r=e.children[n]);r;)r&&Gt(r,t),r=e.children[++n];};var tr=(e,t)=>`on${e}`in t?!0:(m(5,[`Invalid event name "${e}" provided. No such event exists in the DOM API.`,"Only known event listeners can be attached."],t),!1),or=(e,t)=>{let o=e[t.method];return function(n){t.attrs&&(n.attrs=t.attrs),o.call(e,n);}},Pe=(e,t)=>{t.attached&&(t.listener.abort(),t.listener=new AbortController,t.options.signal=t.listener.signal,t.attached=!1,m(1,[`Detached ${t.key} ${t.eventName} event from ${t.method}() method in component`,`${e.scope.define.name}: ${e.scope.key}`]));},it=(e,t,o)=>{if(t.attached)return;if(!(t.method in e)){m(3,`Undefined callback method: ${e.scope.define.name}.${t.method}()`);return}let r=o?F(t,"dom",o).dom:t.dom;rr(r.attributes,t),t.isWindow?tr(t.eventName,window)&&addEventListener(t.eventName,or(e,t)):tr(t.eventName,r)&&r.addEventListener(t.eventName,or(e,t),t.options),t.attached=!0,m(1,[`Attached ${t.key} ${t.eventName} event to ${t.method}() method in component`,`${e.scope.define.name}: ${e.scope.key}`]);};var Se=(e,t,o=!1,r=[])=>{let n=t.length,i=n===1?t[0].split(","):t,a=-1;for(;++a<n;){let c=r[r.push(e(i[a]))-1];if(o&&!c)return !1}return o||r},we={toNode(e){return e},getAttr(e,...t){return t.length===1?e.getAttribute(t[0]):t.reduce((o,r)=>Object.assign(o,{[r]:e.getAttribute(o)}),u())},setAttr(e,...t){return typeof t[0]=="object"?Object.keys(t[0]).forEach(o=>e.setAttribute(o,t[0][o])):e.setAttribute(t[0],t[1]),this},hasAttr(e,...t){return Se(o=>e.hasAttribute(o),t,!0)},removeAttr(e,...t){return Se(o=>!e.hasAttribute(o)||e.removeAttribute(o),t),this},addClass(e,...t){return Se(o=>e.classList.add(o),t),console.log(e,t),this},hasClass(e,...t){return Se(o=>e.classList.contains(o),t,!0)},removeClass(e,...t){return Se(o=>e.classList.remove(o),t),this},toggleClass(e,t,...o){return this.hasClass(e,t)?this.removeClass(e,t).addClass(e,...o):this.addClass(e,t),this},on(){},off(){},watch(){},update(){}};var sr=(e,t)=>{let o=s.config.schema+e.instanceOf,r=(n,i,a=!1)=>{let c=i,l="";typeof i=="object"&&"typeof"in i&&(c=i.typeof,l=i.default),e.state[n]=Ft(c,l);};if(ot(e.state))for(let n in e.define.state)r(n,e.define.state[n]);else for(let n in e.define.state){n in e.state||r(n,e.define.state[n]);let i=Xt(n),a=t.getAttribute(`${o}:${i}`)||t.getAttribute(`${o}:${n}`),c=a!==null&&a!=="",l=`has${rt(n)}`;if(l in e.state||Object.defineProperty(e.state,l,{get:()=>c}),a&&a.startsWith("window."))e.state[n]=window[a.slice(7)];else {let f=e.define.state[n],p=typeof f=="object"?f.typeof:f,y=c?a:typeof f=="object"?f.default:"";e.state[n]=p===Object||p===Array?c?de(y):y:Ft(p,y);}}return new Proxy(e.state,{get:Reflect.get,set:(n,i,a,c)=>{let l=typeof a=="object"||Array.isArray(a)?JSON.stringify(a):String(a);if(t&&l.trim()!==""){let f=`${o}:${i}`,p=t.hasAttribute(f)?f:`${o}:${Xt(i)}`;l===t.getAttribute(p)||t.setAttribute(p,l);}if(i in e.binds)for(let f in e.binds[i])e.binds[i][f].live&&(e.binds[i][f].value=l,V(e.binds[i][f].selector,p=>{p.innerText=l;}));return Reflect.set(n,i,a,c)}})},nr=e=>new Proxy(e,{get:(t,o)=>o in we?(...r)=>we[o](e,...r):e[o]}),ir=({dom:e,name:t})=>new Proxy(()=>e.nodes,{get(o,r,n){let{node:i}=e;if(r===Symbol.toPrimitive)return m(5,`Sugar Error: Use ${Ho(`this.${t}.toNode()`)} for raw element: ${wo(`this.${t}`)}`),()=>"";if(r in we)return (...a)=>we[r](i,...a);if(r in i){let a=Reflect.getPrototypeOf(i),c=Reflect.getOwnPropertyDescriptor(a,r);if(c&&c.get)return Reflect.get(a,r,i);let l=Reflect.get(i,r);return typeof l=="function"?l.bind(i):l}return Reflect.get(o,r,n)},set(o,r,n,i){let{node:a}=e;return r in a?Reflect.set(a,r,n):Reflect.set(o,r,n,i)},apply(o,r,n){let{nodes:i}=e;if(n.length===2)return i.reduce(n[1],n[0]);let a=i.length,c=n[0],l=n[0];if(l==="number")return nr(i[c]);if(l==="string")return i.filter(f=>f.matches(c));if(l==="function"){let f=-1,p=Array(a);for(;++f<a;)p[f]=c(nr(i[f]),f);return p}return Reflect.apply(o,r,n)}});_.scopes=S();function _(e){var t;return t=class{get root(){return Oo()}get dom(){return this.scope.dom}set dom(o){_.scopes.get(this.ref).dom=o;}constructor(o){Reflect.defineProperty(this,"scope",{get:()=>_.scopes.get(o)}),Reflect.defineProperty(this,"ref",{value:o,configurable:!1,enumerable:!1,writable:!1}),console.log(_.scopes),this.state=sr(this.scope,this.dom);}},t.define=Object.assign({name:"",merge:!1,sugar:!1,state:{},nodes:[]},e),t}var De={};Kr(De,{connect:()=>ce,disconnect:()=>ke,hargs:()=>lt,hook:()=>mt,mount:()=>ft,teardown:()=>Qt});var L,ct=I(),cr=()=>U(()=>L=void 0),_t=(e,t)=>{for(let o of t){if(!s.components.o[o])continue;let r=s.components.o[o],n=o.charCodeAt(0);if(n===99)s.components.f.add(r.scope.key),console.log(e),r.dom=e,r.scope.status=2,m(1,`Component ${r.scope.define.name} mounted: ${r.scope.key}`,"#6DD093");else if(n===101)it(r,r.scope.events[o],e);else if(n===110)for(let i in r.scope.nodes)++r.scope.nodes[i].live;else if(n===98){for(let i in r.scope.binds)if(o in r.scope.binds[i]){e.innerText=r.scope.binds[i][o].value,r.scope.binds[i][o].live=!0;break}}}},He=(e,t)=>{for(let o of t){if(!s.components.o[o])continue;let r=s.components.o[o],n=o.charCodeAt(0);if(n===99){r.scope.hooks.unmount===2&&r.unmount(lt()),s.components.f.delete(r.scope.key),r.scope.define.merge&&(r.scope.snapshot=e.innerHTML,m(1,`Component ${r.scope.define.name} snapshot: ${r.scope.key}`,"#999"));for(let i in r.scope.nodes)r.scope.nodes[i].live=0;for(let i in r.scope.binds)for(let a in r.scope.binds[i])r.scope.binds[i][a].live=!1;for(let i in r.scope.events)Pe(r,r.scope.events[i]);r.scope.status=5,m(1,`Component ${r.scope.define.name} unmounted: ${r.scope.key}`,"#7b97ca");}else if(n===101)Pe(r,r.scope.events[o]);else if(n===110)for(let i in r.scope.nodes)--r.scope.nodes[i].live;else if(n===98){for(let i in r.scope.binds)if(o in r.scope.binds[i]){r.scope.binds[i][o].live=!1;break}}}},qe=e=>{if(e.nodeType!==1&&e.nodeType!==11)return;let t=e.getAttribute(s.qs.e);t&&He(e,t.split(","));},lr=e=>{let t=e.getAttribute(s.qs.e);t?_t(e,t.split(",")):K(e.attributes)&&(L?L.p=e:L=Ie(e),ae(e,L));},mr=e=>{L?L.p=e:L=Ie(e),ae(e,L,!1);},fr=(e,t,o,r)=>{o&&(o=o.split(",")),r&&(r=r.split(",")),o&&r?(He(e,o),_t(e,r)):!o&&r?_t(e,r):(L?L.p=e:L=Ie(e,t),o&&!r&&He(e,o),K(t.attributes)&&ae(e,L));};var Jt=(e,t)=>U(()=>{let r=X(e.snap).querySelector(`[${s.qs.e}="${e.ref}"]`);r?(r.innerHTML=e.snapshot,ge(r.ownerDocument.documentElement.outerHTML,e.snap)):m(3,`Component snapshot merge failed: ${e.instanceOf} (${t})`);}),Zt=(e,t)=>{let{page:o,dom:r}=ur(s.page.key),n=e.charCodeAt(0)===114?"removed":"appended";r.head.contains(t)?(r.head[e](t),s.snaps[o.snap]=r.documentElement.outerHTML,m(1,`Snapshot record was updated. Node ${n} from <head>`,t)):m(3,"Node does not exist in the snapshot record, no mutation applied",t);};var lt=()=>u(u(s.page)),Qt=()=>{for(let e in s.components.o)delete s.components.o[e];for(let e of s.components.i.values())for(let t in e.scope.events)Pe(e,e.scope.events[t]);s.components.i.clear(),s.components.f.clear(),m(2,"Component instances were disconnected");},ft=e=>{let t=lt(),o=[];for(let[r,n,i]of e){let a=s.components.i.get(r),c=a.scope.status===4?"unmount":"onmount";a.scope.snap||(a.scope.snap=s.page.snap);let l=async()=>{try{i&&a.scope.status===1?(await a[n](t),await a[i](t)):a.scope.status===4?a.scope.define.merge&&Jt(a.scope,r):await a[n](t),a.scope.status=a.scope.status===4?5:3,a.scope.hooks.connect===2&&(a.scope.hooks.connect=3);}catch(f){return m(3,`Component to failed to ${c}: ${a.scope.instanceOf} (${r})`,f),Promise.reject(r)}};o.push(Ze().then(l));}return Promise.allSettled(o)},mt=()=>{let{f:e,i:t,t:o}=s.components;if(e.size===0&&t.size===0&&o.size>0)return We();let r=[];for(let n of e){if(!t.has(n))continue;let i=t.get(n);if(i.scope.status!==3&&i.scope.status!==5){let a=i.scope.status===4,c=a?"unmount":"onmount";c in i?c==="onmount"&&"connect"in i&&i.scope.hooks.connect===2?r.push([n,"connect",c]):r.push([n,c]):a&&(i.scope.define.merge&&Jt(i.scope,n),i.scope.status=5);}}r.length>0&&ft(r).catch(n=>{let i=t.get(n);i.scope.status=5,e.delete(n);});},ce=()=>{s.components.t.size===0||s.observe.components||(s.page.type===0?We():L?pt(L).then(mt).then(cr):mt(),s.observe.components=!0);},ke=()=>{s.observe.components&&(mt(),s.observe.components=!1);};var J=(e=>{let t=S(),o=(a,c)=>a.setAttribute(s.qs.e,a.hasAttribute(s.qs.e)?`${a.getAttribute(s.qs.e)},${c.shift()}`:c.shift());return {set:a=>(e.push([a,S()]),t=e[e.length-1][1],a),add:(a,c,l=!1)=>t.has(a)?t.get(a).push(c):t.set(a,[c]),sync:(a,c)=>nt(()=>{for(;e.length>0;){let[l,f]=e.shift();for(let[p,y]of f)l.matches(p)&&o(l,y),l.querySelectorAll(p).forEach(d=>o(d,y));f.clear();}ge(a.documentElement.outerHTML,c),m(1,`Snapshot ${s.page.key} updated for: ${s.page.snap}`);})}})([]);var an=(e,t)=>{e.hooks=u(),O(o=>{e.hooks[o]=o in t?2:1;},["connect","onmount","unmount","onmedia"]);},cn=(e,t,o)=>(r,n)=>{if(t===!1||o&&n.status===2){s.components.f.add(n.key),s.components.i.set(n.key,r),m(1,`Component "${n.instanceOf}" connected: ${n.key}`,"#2cc9ee");let i=-1;n.hooks.connect===2&&(i=e.push([n.key,"connect"])-1,n.status=1),n.hooks.onmount===2&&(i=(i>-1?e[i].push("onmount"):e.push([n.key,"onmount"]))-1),i<0&&(n.status=3);}},dr=(e,t,o)=>{for(let r in e.events)o!==null&&e.status===3&&(s.components.o[r]=e.key,t.scope.events[r]=e.events[r]),it(t,e.events[r]);},gr=(e,t)=>{let{scope:o}=t;for(let r in e){let n=e[r],i=`has${rt(r)}`;if(i in t){r in o&&++o[r].live;return}Object.defineProperty(t,i,{get:()=>n.live>0});let a=()=>Ko(n.selector,n.isChild?t.dom:b()),c=()=>Jo(n.selector,n.isChild?t.dom:b());o.define.sugar?(Object.defineProperties(n.dom,{node:{get:a},nodes:{get:c}}),t[r]=ir(n)):Object.defineProperties(t,{[`${r}Node`]:{get:a},[`${r}Nodes`]:{get:c}});}},ln=(e,t,o)=>{let r=o||s.page.type===4,n=cn(e,o,r);return (i,a)=>{if(a)gr(i.nodes,a),dr(i,a,o);else {i.define=u();let c=s.components.t.get(i.instanceOf);_.scopes.set(i.key,F(i,"define",c.define));let l=new c(i.key);an(i,l),gr(i.nodes,l),dr(i,l,o),n(l,i);}}},pt=(e,t)=>{let{r:o,c:r,p:n}=e,i=[],a=hr(),c=ln(i,a,n!==null);for(let l in o){if(!s.components.t.has(l)&&!a.has(l)){m(3,`Component does not exist in registry: ${l}`,o[l]);continue}for(let f of o[l]){if(f.instanceOf==null)if(l in r)f.instanceOf=r[l];else continue;if(a.has(l))for(let p of a.get(l))p.scope.instanceOf===l&&c(f,p);else c(f);}}return U(()=>[a.clear()]),s.page.type===0&&J.sync(t,s.page.snap),i.length>0?ft(i):Promise.resolve()};var ae=(e,t,o=!0)=>{o&&!K(e.attributes)||(e.hasAttribute(s.qs.u)?gn(e,e.getAttribute(s.qs.u),t):yr(e,t,null,null));},mn=(e,t)=>{let o=e.trim().replace(/\s+/," ").split(/[|, ]/);for(let r=0,n=0,i=o.length;r<i;r++)o[r]!==""&&((n=r+2)<i&&o[r+1]==="as"?(t(B(o[r]),B(o[n])),r=n):t(B(o[r]),null));},rr=(e,t)=>{let o=e.length,r=0;for(;++r<o;){let{name:n,value:i}=e[r];if(!s.qs.R.test(n)||n.startsWith(s.qs.y)||!i)continue;let a=n.slice(s.config.schema.length).split(":").pop();t.attrs===null&&(t.attrs=u()),a in t.attrs||(t.attrs[a]=fn(i));}},K=e=>{if(typeof e=="string")return e.indexOf("@")>-1||e===s.qs.u||e===s.qs.g||e===s.qs.E;for(let t=e.length-1;t>=0;t--)if(K(e[t].name))return !0;return !1},ut=(e,t)=>(e.status===2||e.status===3)&&e.dom?e.dom.contains(t):!1;var to=e=>Bo(e.replace(/\s \./g,".")).replace(/\s+/g," ").trim().split(/[ ,]/),fn=e=>{if(Re.test(e))return e==="NaN"?NaN:+e;if(Le.test(e))return e==="true";let t=e.charCodeAt(0);return t===123||t===91?de(e):e},Ie=(e=null,t=null)=>u({c:u(),r:u(),O:null,H:e?u():null,p:e,q:t}),Ue=(e,t,o,r)=>(o||(o=e.getAttribute(t)),`${e.nodeName.toLowerCase()}[${t}${r?"*=":"="}"${o}"]`),dt=(e,{r:t,c:o})=>e in o?Ce(t[o[e]]):e in t?Ce(t[e]):(t[e]=[eo([e])])[0],gt=(e,t,o,r)=>{s.components.o[o]=t;let n=e.getAttribute(s.qs.e);return e.setAttribute(s.qs.e,n?`${n},${o}`:o),r&&J.add(r,o),o},eo=([e,t=null],o,r)=>{let n=u();if(n.key=z(),n.ref=`c.${n.key}`,n.status=5,n.state=u(),n.nodes=u(),n.binds=u(),n.events=u(),o&&(n.snap=null,n.status=2,n.inFragment=ht(o),n.alias=t||null,n.dom=o,gt(o,n.key,n.ref,Ue(o,s.qs.u))),s.components.t.has(e))if(n.instanceOf=e,n.alias)if(s.components.t.has(n.alias))m(5,[`The component alias ("${n.alias}") matches a component identifer in the registry.`,"An alias reference must be unique and cannot match component names."]);else if(n.alias in r.r){for(let{events:i,nodes:a,binds:c}of r.r[n.alias]){if("events"in n)for(let l in i)n.events[l]=i[l],s.components.o[l]=n.key;if("nodes"in n)for(let l in a)n.nodes[l]=a[l],s.components.o[l]=n.key;if("binds"in n)for(let l in c)n.binds[l]=c[l],s.components.o[l]=n.key;}delete r.r[n.alias];}else r.c[n.alias]=e;else n.alias=null;else e?n.alias=e:n.instanceOf=null,n.status===2&&(r.c[n.alias]=null);return n},pn=(e,t,o,r)=>{let n=t.slice(s.config.schema.length),i=n.startsWith("window:"),a=o.indexOf("{"),c=o.trim().split(a>-1?new RegExp("(?<=[$_\\w}])\\s+(?=[$_\\w])"):/\s+/);for(let l=0,f=c.length;l<f;l++){let p=c[l],y=new AbortController,d=u();d.key=`e.${z()}`,d.isWindow=i,d.eventName=i?n.slice(7):n,d.attached=!1,d.selector=Ue(e,Xo(t),p,!0),d.attrs=null,d.options={signal:y.signal};let be=p;if(a>-1){let g=p.slice(a,p.lastIndexOf("}",a)).match(/(passive|once|capture)/g);g!==null&&(d.options.once=g.indexOf("once")>-1,d.options.passive=g.indexOf("passive")>-1,d.options.capture=g.indexOf("capture")>-1),be=p.slice(0,a);}let[Ye,ze]=to(be)[0].split("."),Ge=dt(Ye,r);d.listener=y,d.method=ze.trim(),d.isChild=ut(Ge,e),F(d,"dom",e,!0),gt(e,Ge.key,d.key,d.selector),Ge.events[d.key]=d;}},un=(e,t,o)=>{let r=to(t);for(let n of r){let[i,a]=n.split("."),c=dt(i,o);a in c.nodes?(c.nodes[a].live++,c.nodes[a].isChild=ut(c,e)):c.nodes[a]=u({name:a,selector:`[${s.qs.g}*="${t}"]`,dom:u(),key:`c.${c.key}`,live:1,isChild:ut(c,e)});}},dn=(e,t,o)=>{var r;for(let n of to(t)){let[i,a]=n.split("."),c=dt(i,o),l=`[${s.qs.E}="${t}"]`,f=gt(e,c.key,`b.${z()}`,`${e.nodeName.toLowerCase()}${l}`);(r=c.binds)[a]||(r[a]=u()),c.binds[a][f]=u({key:f,stateKey:a,selector:l,value:e.innerText,live:!0,stateAttr:`${s.config.schema}${i}:${a}`,isChild:ut(c,e)}),F(c.binds[a][f],"dom",e);}},yr=(e,t,o,r)=>{o===null&&r===null&&(t.O=z());for(let n=e.attributes.length-1;n>=0;n--){let{name:i,value:a}=e.attributes[n];if(o){let c=`${s.config.schema}${o}:`;r&&!i.startsWith(c)&&(c=`${s.config.schema}${r}:`),i.startsWith(c)&&(dt(o,t).state[B(i.slice(c.length))]=a);}i.indexOf("@")>-1?pn(e,i,a,t):i===s.qs.E?dn(e,a,t):i===s.qs.g&&un(e,a,t);}},gn=(e,t,o)=>{mn(t,(r,n)=>{if(!s.components.t.has(r))m(3,`Component does not exist in registry: ${r}`);else {let i;r in o.r?(i=Ce(o.r[r]),i.status===5?(i.status=2,i.inFragment=ht(e),i.dom=e,gt(e,i.key,i.ref,Ue(e,s.qs.u))):o.r[r].push(eo([r,n],e,o))):o.r[r]=[eo([r,n],e,o)],i=Ce(o.r[r]),n?o.c[n]=r:i.alias&&!(i.alias in o.c)&&(s.components.t.has(i.alias)?(m(3,`Alias must not match a component identifier: ${i.instanceOf} as ${i.alias}`),i.alias=null):o.c[i.alias]=r),yr(e,o,r,i.alias);}});},We=e=>{let t=Ie();if(e)return e instanceof Set?(e.forEach(o=>ae(o,t)),e.clear(),t):(ae(e,t),t);{let o=J.set(s.snapDom.body);Gt(b(),r=>ae(r,t)),ot(t.r)||pt(t,o.ownerDocument);}};var ht=e=>{for(let[t,o]of s.fragments)if(t===e.id||o.contains(e))return !0;return !1},Et=()=>{s.fragments.clear();let e,t,o,r=b();if(s.page.target.length>0?(console.log(s.page),t=s.qs.d,e=s.page.target.join(),o=_o(r.querySelectorAll(`[id][${s.qs.u}]`))):(t=s.qs.C,e=s.config.fragments.length===1&&s.config.fragments[0]==="body"?s.qs.v:`${s.config.fragments.join()},${s.qs.v}`),V(e,n=>{if(o){for(let i of o)if(n.contains(i)){o.delete(i);break}}if(n.hasAttribute(t)){let i=n.getAttribute(t).trim();n.id!==T&&(i==="true"||i===T)?s.fragments.set(`#${n.id}`,n):s.fragments.set(Ue(n,t,i),n);}else s.fragments.set(`#${n.id}`,n);}),o&&o.size>0){for(let n of o)s.fragments.set(`#${n.id}`,n),s.page.target.push(`#${n.id}`),ct.add(n.id);o.clear();}Z("fragments",[...s.fragments.keys()]);},Er=e=>{e.type===6||e.selector==="body"||e.selector===null||U(()=>{let t=X(e.snap),o=t.body.querySelectorAll(s.qs.T),r=b().querySelectorAll(s.qs.T);V(o,(n,i)=>{if(ht(n))m(3,"The fragment or target is a decedent of an element which morphs",n);else {if(!n.hasAttribute("id"))n.setAttribute("id",`t.${z()}`),r&&r[i].setAttribute("id",`t.${z()}`);else if(n.id.startsWith("t."))return;e.target.push(n.id);}}),ge(t.documentElement.outerHTML,e.snap);});};var A=e=>{let t=et(e);return e.ts=Qe(),e.target=Vt(e),e.selector=Me(e.target),s.config.cache&&(t("cache")||(e.cache=s.config.cache),e.snap||(e.snap=jt())),s.config.hover!==!1&&e.type===10&&(e.threshold||(e.threshold=s.config.hover.threshold)),s.config.proximity!==!1&&e.type===12&&(e.proximity||(e.proximity=s.config.proximity.distance),e.threshold||(e.threshold=s.config.proximity.threshold)),s.config.progress&&(e.progress||(e.progress=s.config.progress.threshold)),t("history")||(e.history=!0),e.scrollY||(e.scrollY=0),e.scrollX||(e.scrollX=0),e.fragments||(e.fragments=s.config.fragments),e.visits||(e.visits=0),e.location||(e.location=ye(e.key)),s.pages[e.key]=e,s.pages[e.key]},xr=e=>{let t=u(bo(To({},e),{target:[],selector:null,cache:s.config.cache,history:!0,scrollX:0,scrollY:0,fragments:s.config.fragments}));return s.config.hover&&(t.threshold=s.config.hover.threshold),s.config.proximity&&(t.proximity=s.config.proximity.distance,t.threshold=s.config.proximity.threshold),s.config.progress&&(t.progress=s.config.progress.threshold),t},Z=(e,t,o=s.history.key)=>{o in s.pages&&e in s.pages[o]&&(e==="location"?s.pages[o][e]=Object.assign(s.pages[e][o],t):e==="target"?(s.pages[o].target=Vt(t),s.pages[o].selector=Me(s.pages[o].target)):s.pages[o][e]=t);},he=(e,t)=>{let o=C("before:cache",e,t),r=typeof o=="string"?o:t;return e.type>5&&e.type>9&&(e.type=1),e.title=zt(t),!s.config.cache||o===!1?e:e.type!==0&&!w(e,"snap")?Q(e,r):(s.pages[e.key]=e,s.snaps[e.snap]=r,Er(e),C("after:cache",e),e)},Q=(e,t=null)=>{let o=e.key in s.pages?s.pages[e.key]:A(e);return t&&(s.snaps[o.snap]=t,e.title=zt(t)),Object.assign(o,e)},ge=(e,t)=>{let o=t=typeof t=="number"?t:null;o?s.snaps[o]=e:m(3,"Snapshot record does not exist, update failed");},ur=e=>{if(!e){if(s.history===null){m(3,"Missing history state reference, page cannot be returned");return}e=s.history.key;}if(e in s.pages)return tt(u(),[["page",()=>s.pages[e]],["dom",()=>ne(s.snaps[s.pages[e].snap])]]);m(5,`No record exists: ${e}`);},X=e=>{let t=typeof e=="string"?e.charCodeAt(0)===47?s.pages[e].snap:e:s.page.snap;return ne(s.snaps[t])},hr=()=>{let e=S(),{i:t,f:o}=s.components;for(let r of o){if(!t.has(r))continue;let n=t.get(r),{scope:i}=n;i.status===2&&(i.alias!==null&&(e.has(i.alias)?e.get(i.alias).push(n):e.set(i.alias,[n])),e.has(i.instanceOf)?e.get(i.instanceOf).push(n):e.set(i.instanceOf,[n]));}return e},vr=e=>{if(!e){if(s.history===null){m(3,"Missing history state reference, page cannot be returned");return}e=s.history.key;}if(w(s.pages,e))return s.pages[e];m(5,`No page record exists for: ${e}`);},M=e=>w(s.pages,e)&&w(s.pages[e],"snap")&&w(s.snaps,s.pages[e].snap)&&typeof s.snaps[s.pages[e].snap]=="string";var Y=e=>{e?typeof e=="string"?(delete s.snaps[s.pages[e].snap],delete s.pages[e]):Array.isArray(e)&&O(t=>{delete s.snaps[s.pages[t].snap],delete s.pages[t];},e):(Yt(s.snaps),Yt(s.pages));};var H=re.replace(/(?:https?:)?(?:\/\/(?:www\.)?|(?:www\.))/,T),ro=(e,t)=>{let o=t?xr(t):u(),r=e.getAttributeNames();for(let n=0,i=r.length;n<i;n++){let a=r[n];if(a.startsWith(s.qs.y)){w(o,"data")||(o.data=u());let c=B(a.slice(s.qs.y.length)),l=e.getAttribute(a).trim();Re.test(l)?o.data[c]=l==="NaN"?NaN:+l:Le.test(l)?o.data[c]=l==="true":l.charCodeAt(0)===123||l.charCodeAt(0)===91?o.data[c]=de(a,l):o.data[c]=l;}else {if(!s.qs.M.test(a))continue;let c=e.getAttribute(a).trim();if(a==="href")o.rev=P(location),t||(o.location=ye(c),o.key=P(o.location));else {let l=a.slice(a.lastIndexOf("-")+1),f=c.replace(Do,T).trim();if(l==="target")o[l]=f==="true"?[]:f!==T?jo(f):[],o.selector=Me(o[l]);else if(Fo.test(f)){let p=f.match(/\[?[^,'"[\]()\s]+\]?/g);o[l]=ko.test(l)?p.reduce(zo(2),[]):p;}else if(l==="position")if(Wt.test(f)){let p=f.match(Wt);o[`scroll${p[0].toUpperCase()}`]=+p[1],p.length===4&&(o[`scroll${p[2].toUpperCase()}`]=+p[3]);}else m(3,`Invalid attribute value on <${a}>, expected: y:number or x:number`,e);else l==="scroll"?Ke.test(f)?o.scrollY=+f:m(3,`Invalid attribute value on <${a}>, expected: number`,e):Le.test(f)&&!Wo.test(a)?o[l]=f==="true":Re.test(f)?o[l]=+f:(l==="history"&&f!=="push"&&f!=="replace"&&m(5,`Invalid attribute value on <${a}>, expected: false, push or replace`,e),o[l]=f);}}}return o},Ee=e=>{let t=u();if(e.length===1&&e.charCodeAt(0)===47)return t.pathname=e,t.hash=T,t.search=T,t;let r=e.indexOf("#");r>=0?(t.hash=e.slice(r),e=e.slice(0,r)):t.hash=T;let n=e.indexOf("?");return n>=0?(t.search=e.slice(n),e=e.slice(0,n)):t.search=T,t.pathname=e,t},xt=(e,t)=>{let o=e.indexOf("/",t);if(o>t){let n=e.indexOf("#",o);return n<0?e.slice(o):e.slice(o,n)}let r=e.indexOf("?",t);if(r>t){let n=e.indexOf("#",r);return n<0?e.slice(r):e.slice(r,n)}return e.length-t===H.length?"/":null},oo=e=>{let t=e.startsWith("www.")?e.slice(4):e,o=t.indexOf("/");if(o>=0){let r=t.slice(o);if(t.slice(0,o)===H)return r.length>0?Ee(r):Ee("/")}else {let r=t.search(/[?#]/);if(r>=0){if(t.slice(0,r)===H)return Ee("/"+t.slice(r))}else if(t===H)return Ee("/")}return null},hn=e=>e.startsWith("http:")||e.startsWith("https:")?1:e.startsWith("//")?2:e.startsWith("www.")?3:0,no=e=>{if(typeof e!="string"||e.length===0)return !1;if(e.charCodeAt(0)===47)return e.charCodeAt(1)!==47?!0:e.startsWith("www.",2)?e.startsWith(H,6):e.startsWith(H,2);if(e.charCodeAt(0)===63)return !0;if(e.startsWith("www."))return e.startsWith(H,4);if(e.startsWith("http")){let t=e.indexOf("/",4)+2;return e.startsWith("www.",t)?e.startsWith(H,t+4):e.startsWith(H,t)}return !1},yn=e=>e.charCodeAt(0)===47?e.charCodeAt(1)!==47?Ee(e):oo(e.slice(2)):e.charCodeAt(0)===63?Ee(location.pathname+e):e.startsWith("https:")||e.startsWith("http:")?oo(e.slice(e.indexOf("/",4)+2)):e.startsWith("www.")?oo(e):null,P=e=>{if(typeof e=="object")return e.pathname+e.search;if(e===T||e==="/")return "/";let t=hn(e);if(t===1){let o=e.charCodeAt(4)===115?8:7,r=e.startsWith("www.",o)?o+4:o;return e.startsWith(H,r)?xt(e,r):null}if(t===2){let o=e.startsWith("www.",2)?6:2;return e.startsWith(H,o)?xt(e,o):null}return t===3?e.startsWith(H,4)?xt(e,4):null:e.startsWith(H,0)?xt(e,0):e.charCodeAt(0)===47?e:null},Tr=({pathname:e,search:t,hash:o}=location)=>u({hostname:H,origin:re,pathname:e,hash:o,search:t}),ye=e=>{if(e===T)return Tr();let t=yn(e);return t===null&&m(3,`Invalid pathname: ${e}`),t.origin=re,t.hostname=H,t},N=(e,t=6)=>{if(e instanceof Element){let r=ro(e);return r.type=t||6,r}let o=u();return e===0?(o.location=Tr(),o.key=o.rev=P(o.location),o.type=e,o.visits=1,s.index=o.key):t===7||t===4?(o.location=ye(e),o.key=o.rev=P(o.location),o.type=t):(o.rev=location.pathname+location.search,o.location=ye(typeof e=="string"?e:o.rev),o.key=P(o.location),o.type=t),o};var Fe=(e,{method:t="GET",body:o=null,headers:r=[["spx-http","href"]],type:n="text"}={})=>new Promise((i,a)=>{let c=new h;c.key=e,c.responseType=n,c.open(t,e,!0);for(let[l,f]of r)c.setRequestHeader(l,f);c.onloadstart=function(){h.n.set(this.key,c);},c.onload=function(){i(this.response);},c.onerror=function(){a(this.statusText);},c.onabort=function(){delete h.s[this.key],h.m.delete(this.key),h.n.delete(this.key);},c.onloadend=function(l){h.n.delete(this.key),s.memory.bytes=s.memory.bytes+l.loaded,s.memory.visits=s.memory.visits+1;},c.send(o);}),vt=e=>e in h.s?(clearTimeout(h.s[e]),delete h.s[e]):!0,Tt=(e,t,o)=>{e in h.s||M(e)||(h.s[e]=setTimeout(t,o));};var so=e=>{for(let[t,o]of h.n)e!==t&&(o.abort(),m(3,`Pending request aborted: ${t}`));},br=e=>{if(s.config.preload!==null){if(Array.isArray(s.config.preload)){let t=s.config.preload.filter(o=>{let r=N(o,3);return r.key!==o?$(A(r)):!1});return Promise.allSettled(t)}else if(typeof s.config.preload=="object"&&w(s.config.preload,e.key)){let t=s.config.preload[e.key].map(o=>$(A(N(o,3))));return Promise.allSettled(t)}}},bt=async e=>{if(e.rev===e.key)return;let t=A(N(e.rev,4));await Yo(),$(t).then(o=>{o?m(2,`Reverse fetch completed: ${o.rev}`):m(3,`Reverse fetch failed: ${e.rev}`);});},Ve=async e=>{if(!h.m.has(e.key))return e;let t=await h.m.get(e.key);return h.m.delete(e.key),delete h.s[e.key],he(e,t)},$=async e=>h.n.has(e.key)&&e.type!==7?(e.type===4&&h.n.has(e.rev)?(h.n.get(e.rev).abort(),m(3,`Request aborted: ${e.rev}`)):m(3,`Request in transit: ${e.key}`),!1):C("fetch",e)?(h.m.set(e.key,Fe(e.key)),Ve(e)):(m(3,`Request cancelled via dispatched event: ${e.key}`),!1);var Nt=(e,t,o)=>{e[o]!==t[o]&&(e[o]=t[o],e[o]?e.setAttribute(o,T):e.removeAttribute(o));},Nr=(e,t)=>{if(t.nodeType===11||e.nodeType===11)return;let o=t.attributes,r=e.getAttribute(s.qs.e),n=t.getAttribute(s.qs.e),i=!1,a,c,l,f,p;for(let d=o.length-1;d>=0;d--)a=o[d],c=a.name,f=a.value,l=a.namespaceURI,l?(c=a.localName||c,p=e.getAttributeNS(l,c),p!==f&&(a.prefix==="xmlns"&&(c=a.name),e.setAttributeNS(l,c,f))):(p=e.getAttribute(c),p!==f&&(e.setAttribute(c,f),!r&&!n&&!i&&(i=K(c))));let y=e.attributes;for(let d=y.length-1;d>=0;d--)y[d]!==void 0&&(a=y[d],c=a.name,f=a.value,l=a.namespaceURI,l?(c=a.localName||c,t.hasAttributeNS(l,c)||e.removeAttributeNS(l,c)):(t.hasAttribute(c)||e.removeAttribute(c),i||(i=K(c))));(r||n||i)&&fr(e,t,r,n);};var Ar=(e,t)=>{let o=e.parentNode;if(o){let r=o.nodeName.toUpperCase();r==="OPTGROUP"&&(o=o.parentNode,r=o&&o.nodeName.toUpperCase()),r==="SELECT"&&!o.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),o.selectedIndex=-1);}Nt(e,t,"selected");},$r=(e,t)=>{Nt(e,t,"checked"),Nt(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value");},io=(e,t)=>{let{value:o}=t;e.value!==o&&(e.value=o);let{firstChild:r}=e;if(r){let{nodeValue:n}=r;if(n===o||!o&&n===e.placeholder)return;r.nodeValue=o;}},Lr=(e,t)=>{if(!t.hasAttribute("multiple")){let o=0,r=-1,n=e.firstElementChild,i,a;for(;n;)if(a=n.nodeName&&n.nodeName.toUpperCase(),a==="OPTGROUP")i=n,n=i.firstElementChild;else {if(a==="OPTION"){if(n.hasAttribute("selected")){r=o;break}o++;}n=n.nextElementSibling,!n&&i&&(n=i.nextElementSibling,i=null);}e.selectedIndex=r;}};var xn=(e,t)=>!t||t==="http://www.w3.org/1999/xhtml"?document.createElement(e):document.createElementNS(t,e),At=(e,t)=>{if(e===t)return !0;let o=e.charCodeAt(0),r=t.charCodeAt(0);return o<=90&&r>=97?e===t.toUpperCase():r<=90&&o>=97?t===e.toUpperCase():!1},vn=(e,t)=>{switch(e.nodeName){case"INPUT":$r(e,t);break;case"OPTION":Ar(e,t);break;case"SELECT":Lr(e,t);break;case"TEXTAREA":io(e,t);break}},ee=e=>e&&"getAttribute"in e?e.getAttribute("id"):void 0,Tn=(e,t)=>{let o=e.firstChild,r;for(;o;)r=o.nextSibling,t.appendChild(o),o=r;return t},$t=(e,t,o,r=!0)=>{qe(e),t&&t.removeChild(e),Rr(e,r,o);},bn=e=>{e.nodeType===1&&e.hasAttribute(s.qs.g)&&mr(e);},Nn=(e,t,o)=>{let r=t.firstChild,n,i,a=e.firstChild,c,l,f,p;e:for(;r;){for(n=ee(r),i=r.nextSibling;a;){if(f=a.nextSibling,r.isEqualNode(a)){bn(a),r=i,a=f;continue e}c=ee(a),l=a.nodeType;let y;if(l===r.nodeType&&(l===1?(n?n!==c&&((p=o.a.get(n))?f&&f.isEqualNode(p)?y=!1:(e.insertBefore(p,a),c?o.l.add(c):$t(a,e,o),a=p,c=ee(a)):y=!1):c&&(y=!1),y=y!==!1&&At(a.nodeName,r.nodeName),y&&Lt(a,r,o)):(l===3||l===8)&&(y=!0,a.nodeValue!==r.nodeValue&&(a.nodeValue=r.nodeValue))),y){r=i,a=f;continue e}c?o.l.add(c):$t(a,e,o),a=f;}n&&(p=o.a.get(n))&&At(p.nodeName,r.nodeName)?(e.appendChild(p),Lt(p,r,o)):(r.actualize&&(r=r.actualize(e.ownerDocument||document)),e.appendChild(r),ao(r,o)),r=i,a=f;}An(e,a,c,o),vn(e,t);},Lt=(e,t,o)=>{let r=ee(t);if(r&&o.a.delete(r),e.isEqualNode(t))return;let n=e.getAttribute(s.qs.p);n!=="false"&&(n!=="children"&&Nr(e,t),e.nodeName==="TEXTAREA"?io(e,t):Nn(e,t,o));},Rr=(e,t,o)=>{if(e.nodeType!==1)return;let r=e.firstChild;for(;r;){let n;t&&(n=ee(r))?o.l.add(n):(qe(r),r.firstChild&&Rr(r,t,o)),r=r.nextSibling;}},ao=(e,t)=>{(e.nodeType===1||e.nodeType===11)&&lr(e);let o=e.firstChild;for(;o;){let r=o.nextSibling,n=ee(o);if(n){let i=t.a.get(n);i&&At(o.nodeName,i.nodeName)?(o.parentNode.replaceChild(i,o),Lt(i,o,t)):ao(o,t);}else ao(o,t);o=r;}},An=(e,t,o,r)=>{for(;t;){let n=t.nextSibling;(o=ee(t))?r.l.add(o):$t(t,e,r),t=n;}},Or=(e,t)=>{if(e.nodeType===1||e.nodeType===11){let o=e.firstChild;for(;o;){let r=ee(o);r&&t.a.set(r,o),Or(o,t),o=o.nextSibling;}}},xe=(e,t)=>{let o=t.cloneNode(!0),r=u({l:I(),a:S()});o.nodeType===11&&(o=o.firstElementChild),Or(e,r);let n=e,i=n.nodeType,a=o.nodeType;if(i===1)a===1?At(e.nodeName,o.nodeName)||(qe(e),n=Tn(e,xn(o.nodeName,o.namespaceURI))):n=o;else if(i===3||i===8){if(a===i)return n.nodeValue!==o.nodeValue&&(n.nodeValue=o.nodeValue),n;n=o;}if(n.isEqualNode(o))qe(e);else {if(o.isEqualNode(n))return n;if(Lt(n,o,r),r.l.size>0){for(let c of r.l)if(r.a.has(c)){let l=r.a.get(c);$t(l,l.parentNode,r,!1);}}}return n!==e&&e.parentNode&&(n.actualize&&(n=n.actualize(e.ownerDocument||document)),e.parentNode.replaceChild(n,e)),r.a.clear(),r.l.clear(),n};var je=(e,t)=>{if(!(e instanceof Element))return !1;let o=e.closest(t);return o&&o.tagName==="A"?o:!1},Rt=e=>{if(e.nodeName!=="A")return 2;let t=e.getAttribute("href");if(!t||!no(t))return 2;let o=P(t);return o===null?2:M(o)?2:1},Cr=(e,t)=>{let o=[];return V(e,r=>{if(r.nodeName!=="A")V(t,n=>Rt(n)===1?o.push(n):null);else if(r.hasAttribute("href")&&no(r.href)){let n=P(r.href);P(n)!==null&&M(n)===!1&&o.push(r);}}),o},Be=e=>{let t=[];return V(e,o=>Rt(o)===1?t.push(o):null),t};var Mr=e=>{let t=je(e.target,s.qs.h);if(!t)return;let o=N(t,10);if(M(o.key)||o.key in h.s)return;t.addEventListener(`${R}leave`,Pr,{once:!0});let r=A(o),n=r.threshold||s.config.hover.threshold;Tt(o.key,function(){C("prefetch",t,o)&&$(r).then(function(){delete h.s[o.key],Sr(t);});},n);},Pr=e=>{let t=je(e.target,s.qs.h);t&&vt(P(t.href));},Ln=e=>e.addEventListener(`${R}enter`,Mr),Sr=e=>{e.removeEventListener(`${R}enter`,Mr),e.removeEventListener(`${R}leave`,Pr);},Ot=()=>{!s.config.hover||s.observe.hover||(O(Ln,Be(s.qs.h)),s.observe.hover=!0);},ve=()=>{s.observe.hover&&(O(Sr,Be(s.qs.h)),s.observe.hover=!1);};var me,Rn=async e=>{if(e.isIntersecting){let t=N(e.target,11);if(!C("prefetch",e.target,t))return me.unobserve(e.target);await $(A(t))?me.unobserve(e.target):(m(3,`Prefetch will retry at next intersect for: ${t.key}`),me.observe(e.target));}},Ct=()=>{if(!s.config.intersect||s.observe.intersect)return;me||(me=new IntersectionObserver(O(Rn),s.config.intersect));let e=O(o=>me.observe(o)),t=Cr(s.qs.P,s.qs.S);e(t),s.observe.intersect=!0;},Te=()=>{s.observe.intersect&&(me.disconnect(),s.observe.intersect=!1);};var On=e=>{let t=b().querySelectorAll(`${s.page.target.join()},[${s.qs.d}]`);for(let o=0,r=t.length;o<r;o++)if(t[o].contains(e))return !1;return !0},Mt=new MutationObserver(([e])=>{if(e.type!=="childList"||e.addedNodes.length===0&&e.removedNodes.length===0)return;let t=e.addedNodes.length,o=t?e.addedNodes[0]:e.removedNodes[0];if(o.nodeType===1){if(s.eval&&Uo.test(o.nodeName))o.parentNode.nodeName==="HEAD"?t?Zt("appendChild",o):Zt("removeChild",o):On(o)&&s.resources.has(o)?s.resources.delete(o):s.resources.add(o);else if(o instanceof HTMLElement){let r=o.getAttribute(s.qs.e);t&&r===null?We(o):r&&He(o,r.split(","));}}}),Pt=()=>{s.observe.mutations||(Mt.observe(document.head,{childList:!0}),Mt.observe(b(),{childList:!0,subtree:!0}),s.observe.mutations=!0);},St=()=>{if(s.observe.mutations){Mt.takeRecords(),Mt.disconnect();for(let e of s.resources)b().removeChild(e),s.resources.delete(e);s.observe.mutations=!1;}};var Cn=({clientX:e,clientY:t},o)=>e<=o.right&&e>=o.left&&t<=o.bottom&&t>=o.top,Mn=e=>{let t=e.getBoundingClientRect(),o=e.getAttribute(s.qs.b),r=Ke.test(o)?Number(o):s.config.proximity.distance;return {target:e,top:t.top-r,bottom:t.bottom+r,left:t.left-r,right:t.right+r}},Pn=(e,t=!1)=>o=>{if(t)return;t=!0;let r=e.findIndex(n=>Cn(o,n));if(r===-1)U(()=>t=!1,s.config.proximity.throttle);else {let{target:n}=e[r];if(Rt(n)===2)e.splice(r,1);else {let i=A(N(n,12)),a=i.threshold||s.config.proximity.threshold;Tt(i.key,async()=>{if(!C("prefetch",n,i))return te();await $(i)&&(e.splice(r,1),t=!1,e.length===0&&(te(),m(2,"Proximity observer disconnected")));},a);}}},mo,wt=()=>{if(!s.config.proximity||s.observe.proximity)return;let t=Be(s.qs.b).map(Mn);t.length>0&&(mo=Pn(t),addEventListener(`${R}move`,mo,{passive:!0}),s.observe.proximity=!0);},te=()=>{s.observe.proximity&&(removeEventListener(`${R}move`,mo),s.observe.proximity=!1);};var Sn=async(e,t)=>{if(!s.eval||!e.children||!t.children)return;let o=e.children,r=I(),n=t.children,i=[];for(let l=0,f=n.length;l<f;l++)Ut(n[l])&&r.add(n[l].outerHTML);for(let l=0,f=o.length;l<f;l++){let p=o[l],y=Ut(p),d=p.outerHTML;r.has(d)?y?i.push(p):r.delete(d):y&&i.push(p);}let a=[],c=document.createRange();for(let l of r){let f=c.createContextualFragment(l).firstChild;if(w(f,"href")||w(f,"src")){let p,y=new Promise(d=>p=d);f.addEventListener("load",()=>p()),f.addEventListener("error",d=>{m(3,`Resource <${f.nodeName.toLowerCase()}> failed:`,d),p();}),a.push(y);}e.appendChild(f),r.delete(l);}for(let l=0,f=i.length;l<f;l++)e.removeChild(i[l]);await Promise.allSettled(a);},wn=(e,t)=>{let o=b();if(e.selector==="body"||e.fragments.length===0)xe(o,t.body);else {let r=e.target.length>0?s.fragments.keys():e.fragments,n=s.components.t.size>0;for(let i of r){let a=s.fragments.get(i),c=t.body.querySelector(i);if(!(!c||!a)&&C("render",a,c))if(ct.has(c.id))c.setAttribute(s.qs.e,a.getAttribute(s.qs.e));else {if(a.isEqualNode(c))continue;n&&J.set(c),xe(a,c);}}}if(L&&J.sync(t,e.snap),e.type!==6&&Z("type",6),e.location.hash!==T){let r=o.querySelector(e.location.hash);r&&r.scrollIntoView();}scrollTo(e.scrollX,e.scrollY);},W=e=>{ve(),Te(),te(),St(),ke(),Et(),s.eval===!1&&(document.title=e.title);let t=X(e.snap);return Sn(Co(),t.head),wn(e,t),ie.done(),Ot(),Ct(),wt(),ce(),Pt(),C("load",e),e};var E=window.history,Hr=()=>E.state!==null&&"spx"in E.state&&"rev"in E.state.spx&&E.state.spx.key!==E.state.spx.rev,uo=e=>{if(E.state===null||typeof E.state!="object"||!("spx"in E.state))return !1;let t=et(E.state.spx)(["key","rev","scrollX","scrollY","title","target"]);return typeof e=="string"?t&&E.state.spx.key===e:t},Hn=async()=>{await Ze(),s.loaded=!0;},qn=e=>(uo(e.key)?(Object.assign(e,E.state.spx),scrollTo(E.state.spx.scrollX,E.state.spx.scrollY)):oe(e),e),oe=({key:e,rev:t,title:o,scrollX:r,scrollY:n,target:i})=>(E.replaceState({spx:u({key:e,rev:t,scrollX:r,scrollY:n,target:i,title:o||document.title})},o,e),m(1,`History replaceState: ${e}`),E.state.spx),fe=({key:e,rev:t,title:o,scrollX:r,scrollY:n,target:i})=>(E.pushState({spx:u({key:e,rev:t,scrollX:r,scrollY:n,target:i,title:o||document.title})},o,e),m(1,`History pushState: ${e}`),E.state.spx),qr=async e=>{if(e.state===null||!("spx"in e.state))return;let{spx:t}=e.state;if(M(t.key)){!M(t.rev)&&t.rev!==t.key&&bt(t),Z("type",5,t.key);let{type:o,key:r}=W(s.pages[t.key]);o===4?m(1,`History popState reverse: ${r}`):m(1,`History popState session: ${r}`);}else {m(1,`History popState fetch: ${t.key}`),t.type=5;let o=await $(t);if(!o)return location.assign(t.key);let r=P(location);if(o.key===r)m(1,`History popState fetch Complete: ${t.key}`,"#2cc9ee"),o.target=[],o.selector=null,W(o);else if(M(r))W(s.pages[r]);else {let n=A(N(r,5)),i=await $(n);i&&fe(i);}}},Ir=e=>{if(!s.observe.history)return addEventListener("popstate",qr,!1),s.observe.history=!0,typeof e=="object"&&e.type===0?qn(e):e},kr=()=>{s.observe.history&&(E.scrollRestoration&&(E.scrollRestoration="auto"),removeEventListener("popstate",qr,!1),removeEventListener("load",Hn,!1),s.observe.history=!1);};var In=e=>{for(let t of ["hover","intersect","proximity","progress"])w(e,t)&&(e[t]===!1?s.config[t]=!1:typeof e[t]=="object"&&Object.assign(s.config[t],e[t]),delete e[t]);return e},Xe=(e,t)=>{let o=`:not([${e}${t}=false]):not([${e}link])`;switch(t.charCodeAt(0)){case 104:return `${o}:not([${e}proximity]):not([${e}intersect])`;case 105:return `${o}:not([${e}hover]):not([${e}proximity])`;case 112:return `${o}:not([${e}intersect]):not([${e}hover])`}},kn=(e,t,o)=>{if("eval"in e)if(e.eval){if(typeof e.eval=="object"){let r=Object.assign(s.config.eval,e.eval);s.eval=!(r.link===!1&&r.meta===!1&&r.script===!1&&r.style===!1);}}else s.eval=!1;return r=>{if(s.eval===!1||s.config.eval[r]===!1)return `${r}[${t}eval]:${o}`;if(s.config.eval[r]===!0)return `${r}:${o}`;let n=r==="link"?`${r}[rel=stylesheet]:${o}`:r==="script"?`${r}:${o}:not([${t}eval=hydrate])`:`${r}:${o}`;if(s.config.eval[r]===null)return n;if(Array.isArray(s.config.eval[r]))return s.config.eval[r].length>0?s.config.eval[r].map(i=>`${i}:${o}`).join(","):(m(3,`Missing eval ${r} value, SPX will use defaults`),n);m(4,`Invalid eval ${r} value, expected boolean or array`);}},Dn=e=>{let t=[];if("fragments"in e&&Array.isArray(e.fragments)&&e.fragments.length>0)for(let o of e.fragments){let r=o.charCodeAt(0);if(r===46||r===91){m(3,[`Invalid fragment selector "${o}" provided. Fragments must be id annotated values.`,"Use spx-target attributes for additional fragment selections."]);continue}else r===35?t.push(o.trim()):t.push(`#${o.trim()}`);}else return ["body"];return t},Dr=(e=u())=>{"logLevel"in e&&(s.logLevel=e.logLevel,s.logLevel===1&&m(1,"Verbose Logging")),Zo(),Object.defineProperties(s,{history:{get:()=>typeof E.state=="object"&&"spx"in E.state?E.state.spx:null},ready:{get:()=>document.readyState==="complete"},types:{get:()=>u({INITIAL:0,PREFETCH:1,FETCH:2,PRELOAD:3,REVERSE:4,POPSTATE:5,VISIT:6,HYDRATE:7,CAPTURE:8,RELOAD:9,HOVER:10,INTERSECT:11,PROXIMITY:12})}}),"components"in e&&(G(e.components),delete e.components),Object.assign(s.config,In(e));let t=s.config.schema,o=t==="spx"?"spx":t.endsWith("-")?t:t===null?T:`${t}-`,r=`:not([${o}disable]):not([href^=\\#])`,n=`not([${o}eval=false])`,i=kn(e,o,n);s.config.fragments=Dn(e),s.config.schema=o,s.config.index=null,s.memory.bytes=0,s.memory.visits=0,s.memory.limit=s.config.maxCache,Object.assign(s.qs,{M:new RegExp(`^href|${o}(hydrate|append|prepend|target|progress|threshold|scroll|position|proximity|hover|cache|history)$`,"i"),I:new RegExp(`${o}(?:node|bind|component)|@[a-z]|[a-z]:[a-z]`,"i"),R:new RegExp(`^${o}[a-zA-Z0-9-]+:`,"i"),d:`${o}target`,C:`${o}fragment`,v:`[${o}fragment]`,T:`[${o}target]:not(a[spx-target]):not([${o}target=false])`,p:`${o}morph`,L:`${o}eval`,P:`[${o}intersect]${Xe(o,"intersect")}`,k:`[${o}track]:not([${o}track=false])`,u:`${o}component`,g:`${o}node`,E:`${o}bind`,e:"data-spx",w:s.config.annotate?`a[${o}link]${r}`:`a${r}`,x:i("script"),D:i("style"),A:i("link"),N:i("meta"),W:`script[${o}eval=hydrate]:${n}`,U:`link[rel=stylesheet][href*=\\.css]:${n},script[src*=\\.js]:${n}`,y:`${o}data:`,b:`a[${o}proximity]${r}${Xe(o,"proximity")}`,S:`a${r}${Xe(o,"intersect")}`,h:s.config.hover!==!1&&s.config.hover.trigger==="href"?`a${r}${Xe(o,"hover")}`:`a[${o}hover]${r}${Xe(o,"hover")}`}),ie.style(s.config.progress);};var Wn=e=>!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.button>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey),D=function(e){if(!Wn(e))return;let t=je(e.target,s.qs.w);if(!t)return;let o=P(t.href);if(o===null)return;let r=o===s.page.key,n=()=>{m(3,`Drag occurance, visit cancelled: ${o}`),D.drag=!0,t.removeEventListener(`${R}move`,n);};if(t.addEventListener(`${R}move`,n,{once:!0}),D.drag===!0)return D.drag=!1,D(e);if(t.removeEventListener(`${R}move`,n),!C("visit",e))return;let i=(a,c=!0)=>{s.pages[a.key].ts=Qe(),s.pages[a.key].visits=a.visits+1,s.pages[a.key].target=s.pages[a.rev].target=a.target,s.pages[a.key].selector=s.pages[a.rev].selector=a.selector,s.pages[a.rev].scrollX=window.scrollX,s.pages[a.rev].scrollY=window.scrollY,r?m(2,`Identical pathname, page visit skipped: ${o}`):(oe(s.pages[a.rev]),c?(fe(a),W(a)):Wr(a));};if(ve(),te(),Te(),M(o)){let a=ro(t,s.pages[o]),c=Q(a);t.onclick=l=>{l.preventDefault(),i(c);};}else if(h.m.has(o)){so(o),m(2,`Request in transit: ${o}`);let a=s.pages[o];t.onclick=c=>{c.preventDefault(),i(a,!1);};}else {so(),vt(o);let a=A(N(t,6));$(a),t.onclick=c=>{c.preventDefault(),i(a,!1);};}};async function Wr(e){e.progress&&ie.start(e.progress);try{let t=await Ve(e);t?(t.history==="replace"?oe(t):fe(t),W(t)):location.assign(e.key);}catch(t){location.assign(e.key);}}var ho=async(e,t)=>{if(t){typeof t.cache=="string"&&(t.cache==="clear"?Y():Y(t.key)),t.progress&&ie.start(t.progress);let o=await $(t);o?(fe(o),W(o)):location.assign(t.key);}else return Wr(s.pages[e])},Ur=()=>{s.observe.hrefs||(D.drag=!1,Ae==="mouseOnly"?addEventListener(`${R}down`,D,!1):(Ae==="touchOnly"||addEventListener(`${R}down`,D,!1),addEventListener("touchstart",D,!1)),s.observe.hrefs=!0);},Fr=()=>{s.observe.hrefs&&(Ae==="mouseOnly"?removeEventListener(`${R}down`,D,!1):(Ae==="touchOnly"||removeEventListener(`${R}down`,D,!1),removeEventListener("touchstart",D,!1)),s.observe.hrefs=!1);};var jr=()=>{let e=N(0),t=Ir(A(e));tt(s,[["prev",()=>s.pages[s.history.rev]],["page",()=>s.pages[s.history.key]],["snapDom",()=>ne(s.snaps[s.page.snap])]]);let o=()=>{let r=he(t,se());return Ur(),Et(),Ot(),Ct(),wt(),ce(),Pt(),nt(()=>Z("type",6),async()=>await bt(r),async()=>await br(r)),r};return new Promise(r=>{document.readyState==="loading"?addEventListener("DOMContentLoaded",()=>r(o())):r(o());})},Br=()=>{kr(),Fr(),St(),ve(),Te(),te(),s.config.components&&(ke(),Qt(),s.components.t.clear()),Y(),s.config.globalThis&&delete window.spx,m(2,"Disconnected");};function v(e={}){if(It===!1)return m(5,"Invalid runtime environment: window is undefined.");if(!v.supported)return m(5,"Browser does not support SPX");if(!window.location.protocol.startsWith("http"))return m(5,"Invalid protocol, SPX expects HTTPS or HTTP protocol");Dr(e),s.config.globalThis&&!("spx"in window)&&F(window,"spx",v);let t=jr();return async function(o){let r=await t;if(o.constructor.name==="AsyncFunction")try{await o(r);}catch(n){m(3,"Connection Error",n);}else o(r);m(2,"Connection Established");}}v.Component=_;v.on=Qo;v.off=er;v.component=yo;v.live=Fn;v.capture=Gn;v.form=Kn;v.render=zn;v.session=jn;v.reload=Bn;v.fetch=Xn;v.clear=Y;v.hydrate=Jn;v.prefetch=_n;v.route=Zn;v.disconnect=Br;v.register=Vn;v.dom=Yn;v.supported=Un();Object.defineProperties(v,{$:{get:()=>s},history:{value:{get state(){return s.history},api:E,push:fe,replace:oe,has:uo,reverse:Hr}}});function Un(){return !!(It&&window.history.pushState&&window.requestAnimationFrame&&window.DOMParser&&window.Proxy)}function Fn(e=null,...t){let o=e?[e,...t].flat():null,r={};for(let{scope:{alias:n,instanceOf:i}}of s.components.i.values()){let a=o?o.includes(n)?n:o.includes(i)?i:null:null;r[a||!o&&(n||i)]=Array.isArray(r[a||!o&&i])?[...r[a||!o&&i],yo]:yo;}return r}function yo(e,t){let o=[];for(let r of s.components.i.values()){let{scope:n}=r;(n.instanceOf===e||n.alias===e)&&o.push(r);}return t?O(t,o):o[0]}function Vn(...e){if(typeof e[0]=="string")e.length>2&&m(5,[`Named component registration expects 2 parameters, recieved ${e.length}.`,'Registry should follow this structure: spx.register("identifer", YourComponent)'],e),G({[De[0]]:e[1]});else for(let t of e)if(Array.isArray(t))for(let o of t)typeof o[0]=="string"?G({[o[0]]:o[1]}):typeof o=="function"&&G({[st(o)]:o},!0);else console.log(t),typeof t=="function"?G({[st(t)]:t},!0):typeof t=="object"&&G(t);ce();}function jn(){return Object.defineProperties(u(),{config:{get:()=>s.config},snaps:{get:()=>s.snaps},pages:{get:()=>s.pages},observers:{get:()=>s.observe},components:{get:()=>s.components},fragments:{get:()=>s.fragments},memory:{get:()=>s.memory.size=Go(s.memory.bytes)}})}async function Bn(){s.page.type=9;let e=await $(s.page);return e?(m(2,"Triggered reload, page was re-cached"),W(e)):(m(3,"Reload failed, triggering refresh (cache will purge)"),location.assign(s.page.key))}async function Xn(e){let t=N(e,2);t.location.origin!==re&&m(5,"Cross origin fetches are not allowed");let o=await Fe(t.key);if(o)return o}function Yn(e,...t){let o=e[0];for(let c=0,l=t.length;c<l;c++)o+=t[c]+e[c+1];let r=o,n=document.createElement("div");n.innerHTML=r;let i=n.children.length;if(i===0)return null;if(i===1)return F(n.children[0],"raw",r);let a=F([],"raw",r);for(;n.firstChild;){let c=n.firstElementChild;c&&a.push(c),n.removeChild(n.firstChild);}}async function zn(e,t,o){let r=s.page,n=N(e);n.location.origin!==re&&m(5,"Cross origin fetches are not allowed");let i=await Fe(n.key,{type:"document"});if(i||m(5,`Fetch failed for: ${n.key}`,i),await o.call(r,i),t==="replace"){r.title=i.title;let a=Q(Object.assign(r,n),se(i));return oe(a),a}else return W(he(n,se(i)))}function Gn(e){let t=vr();if(!t)return;let o=X();if(e=Array.isArray(e)?e:t.target,e.length===1&&e[0]==="body"){xe(o.body,b()),Q(t,se(o));return}let r=e.join(","),n=b().querySelectorAll(r);V(o.body.querySelectorAll(r),(i,a)=>{xe(i,n[a]);}),Q(t,se(o));}async function _n(e){let t=N(e,1);if(M(t.key)){m(3,`Cache already exists for ${t.key}, prefetch skipped`);return}let o=await $(A(t));if(o)return o;m(5,`Prefetch failed for ${t.key}`);}async function Kn(e,t){let o=new FormData;for(let n in t.data)o.append(n,t.data[n]);return await Fe(e,{method:t.method,body:o})}async function Jn(e,t){let o=N(e,7);if($(o),Array.isArray(t)){o.hydrate=[],o.preserve=[];for(let n of t)n.charCodeAt(0)===33?o.preserve.push(n.slice(1)):o.hydrate.push(n);}else o.hydrate=s.config.fragments;let r=await Ve(o);if(r){let{key:n}=s.history;if(oe(r),W(r),o.key!==n){s.index===n&&(s.index=o.key);for(let i in s.pages)s.pages[i].rev===n&&(s.pages[i].rev=o.key);Y(n);}}return X(r.key)}async function Zn(e,t){let o=N(e),r=typeof t=="object"?Object.assign(o,t):o;return M(o.key)?ho(o.key,Q(r)):ho(o.key,A(r))}

export { v as default };
