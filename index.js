/**
* SPX ~ Single Page XHR | https://spx.js.org
*
* @license CC BY-NC-ND 4.0
* @version 0.1.2-beta.1
* @copyright 2024 Nikolas Savvidis
*/
var bo=Object.defineProperty,Yr=Object.defineProperties;var Kr=Object.getOwnPropertyDescriptors;var vo=Object.getOwnPropertySymbols;var Jr=Object.prototype.hasOwnProperty,Zr=Object.prototype.propertyIsEnumerable;var To=(e,t,o)=>t in e?bo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,No=(e,t)=>{for(var o in t||(t={}))Jr.call(t,o)&&To(e,o,t[o]);if(vo)for(var o of vo(t))Zr.call(t,o)&&To(e,o,t[o]);return e},Ao=(e,t)=>Yr(e,Kr(t));var Qr=(e,t)=>{for(var o in t)bo(e,o,{get:t[o],enumerable:!0});};var I=typeof window!="undefined"?window:{screen:{},navigator:{}},ye=(I.matchMedia||function(){return {matches:!1}}).bind(I),ts={get passive(){return !0}},Co=function(){};I.addEventListener&&I.addEventListener("p",Co,ts);I.removeEventListener&&I.removeEventListener("p",Co,!1);var Ut="ontouchstart"in I,os="TouchEvent"in I,Wt=Ut||os&&ye("(any-pointer: coarse)").matches,$o=(I.navigator.maxTouchPoints||0)>0||Wt,Lo=I.navigator.userAgent||"",rs=ye("(pointer: coarse)").matches&&/iPad|Macintosh/.test(Lo)&&Math.min(I.screen.width||0,I.screen.height||0)>=768,ss=(ye("(pointer: coarse)").matches||!ye("(pointer: fine)").matches&&Ut)&&!/Windows.*Firefox/.test(Lo),ns=ye("(any-pointer: fine)").matches||ye("(any-hover: hover)").matches||rs||!Ut,Le=$o&&(ns||!ss)?"hybrid":$o?"touchOnly":"mouseOnly";var Ft=typeof window!="undefined";"content"in document.createElement("template");document.createRange&&"createContextualFragment"in document.createRange();var O=Wt?"pointer":"mouse",ae=window.location.origin,wo=Object.create,A="",Mo=()=>document.documentElement,$=()=>document.body,tt=()=>document.head,p=e=>e?Object.assign(wo(null),e):wo(null),j=e=>new Set(e),Po=e=>new Proxy(p(),e),P=()=>new Map;var h=class extends XMLHttpRequest{constructor(){super(...arguments);this.key=null;}};h.o=P(),h.c=P(),h.r=p();var y={marks:j(),store:void 0,snaps:[]},s={index:"",eval:!0,patched:!1,loaded:!1,logLevel:2,qs:p(),fragments:P(),mounted:j(),registry:P(),instances:P(),maps:Po({get:(e,t)=>s.instances.get(e[t])}),events:p(),observe:p(),memory:p(),pages:p(),snaps:p(),resources:j(),config:{fragments:["body"],timeout:3e4,globalThis:!0,schema:"spx-",logLevel:3,cache:!0,components:null,maxCache:100,reverse:!0,preload:null,annotate:!1,eval:{script:null,style:null,link:null,meta:!1},hover:{trigger:"href",threshold:250},intersect:{rootMargin:"0px 0px 0px 0px",threshold:0},proximity:{distance:75,threshold:250,throttle:500},progress:{bgColor:"#111",barHeight:"3px",minimum:.08,easing:"linear",speed:200,threshold:500,trickle:!0,trickleSpeed:200}}};var jt=class extends Error{constructor(o,r){super(o);this.context=r;this.name="SPX Error",r&&(this.context=r);}},ot="SPX ",as="\x1B[",cs="\x1B[0m",ls=(e,t)=>as+e+t+cs,x=(e,t="#999")=>{s.logLevel===3&&console.debug("%c"+ot+(Array.isArray(e)?e.join(" "):e),`color: ${t};`);},u=(e,t)=>{s.logLevel>=1&&(t?console.warn(ot+e,t):console.warn(ot+e));},k=(...e)=>{s.logLevel===2&&console.info(ot+ls("90m",e.join("")));},T=(e,t)=>{throw new jt(e,t)};var Oo=/&(?:amp|lt|gt|quot|#39|#x2F|#x60|#x3D);/g,qo=/^[A-Z]|[_-]/;var So=/\b(?:append|prepend)/,Ho=/\s+/g,Me=/^\b(?:true|false)$/i,rt=/^\d*\.?\d+$/,Pe=/^(?:[.-]?\d*\.?\d+|NaN)$/;var Ro=/\b(?:intersect|hover|proximity)\b/;var Do=/\b(?:SCRIPT|STYLE|LINK)\b/,ko=/\[(['"]?.*['"]?,?)\]/,Vt=/[xy]\s*|\d*\.?\d+/gi;var Oe=j(),Io={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&#x60;":"`","&#x3D;":"="};function H(e,t){if(arguments.length===1)return i=>H(e,i);let o=t.length;if(o===0)return;let r,n=-1;for(;++n<o&&(r=e(t[n],n,t),r!==!1););return r}var Uo=e=>{let t=e.replace(/\s+,/g,",").replace(/,\s+/g,",").replace(/['"]/g,"");return t.charCodeAt(0)===91&&(/^\[\s*\[/.test(t)||/,/.test(t)&&/\]$/.test(t))&&(t=t.replace(/^\[/,"").replace(/\]$/,"")),t.split(/,|\|/)},z=(e,t)=>{try{let o=(t||e).replace(/\\'|'/g,r=>r[0]==="\\"?r:'"').replace(/"(?:\\.|[^"])*"/g,r=>r.replace(/\n/g,"\\n")).replace(/\[|[^[\]]*|\]/g,r=>/[[\]]/.test(r)?r:r.split(",").map(n=>n.replace(/^(\w+)$/,'"$1"').replace(/^"([\d.]+)"$/g,"$1")).join(",")).replace(/([a-zA-Z0-9_-]+)\s*:/g,'"$1":').replace(/:\s*([$\w-]+)\s*([,\]}])/g,':"$1"$2').replace(/,(\s*[\]}])/g,"$1").replace(/([a-zA-Z_-]+)\s*,/g,'"$1",').replace(/([\]},\s]+)?"(true|false)"([\s,{}\]]+)/g,"$1$2$3");return JSON.parse(o)}catch(o){return T("Invalid JSON in attribute value: "+JSON.stringify(e||t,null,2),o),t}},qe=e=>e[e.length-1],Wo=e=>e.replace(/\s+/g," ").trim(),Fo=e=>e.replace(/\./g,"\\.").replace(/@/g,"\\@").replace(/:/g,"\\:"),jo=()=>new Promise(e=>setTimeout(()=>e(),1)),B=(e,t=1,o)=>setTimeout(()=>e(),t),nt=()=>Promise.resolve();var Bt=e=>{switch(e.nodeName){case"SCRIPT":return e.matches(s.qs.g);case"STYLE":return e.matches(s.qs.g);case"META":return e.matches(s.qs.v);case"LINK":return e.matches(s.qs.T);default:return e.getAttribute(s.qs.b)!=="false"}};var ms=e=>e.replace(Oo,t=>Io[t]||t),it=()=>new Date().getTime(),at=e=>{let t=typeof e=="object";return o=>t&&o?typeof o=="string"?o in e:o.every(r=>r?r in e:!1):!1},R=(e,t)=>typeof e=="object"?t in e:!1,Gt=e=>{switch(e){case String:return "";case Boolean:return !1;case Number:return 0;case Object:return {};case Array:return [];default:return e}},J=(e,t,o,r=null)=>r!==null?t in e?e:Object.defineProperty(e,t,{get:()=>o,configurable:r}):Object.defineProperty(e,t,{get:()=>o});var Xt=e=>"target"in e?e.target.length===1&&e.target[0]==="body"?e.target:e.target.includes("body")?(u(`The body selector passed via ${s.qs.f} will override`),["body"]):e.target.filter((t,o,r)=>t!==""&&t.indexOf(",")===-1?r.indexOf(t)===o:!1):s.config.fragments.length===1&&s.config.fragments[0]==="body"?["body"]:[],Vo=e=>{let t=e.tagName.toLowerCase();if(e.id)return t+"#"+e.id;if(e.hasAttribute("class")){let o=e.className.trim().replace(/\s+/g,".");o&&(t+="."+o);}return `${t}:nth-child(${Array.prototype.indexOf.call(e.parentNode.children,e)+1})`},Se=e=>e.length===1&&e[0]==="body"?"body":e.length===0?null:e.join(","),He=e=>{let t=typeof e;if(t==="object"){for(let o in e)return !1;return !0}return t==="string"?e[0]===void 0:Array.isArray(e)?e.length>0:null};var zt=(e=Math.floor(Math.random()*89999+1e4))=>Oe.has(e)?zt():(Oe.add(e),e),Z=function e(t=5){let o=Math.random().toString(36).slice(-t);return Oe.has(o)?e(t):(Oe.add(o),o)};var Bo=(e=2)=>(t,o)=>{let r=t.length;return (r<1||t[r-1].length===e?t.push([o]):t[r-1].push(o))&&t},Go=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":e<1073741824?(e/1048576).toFixed(1)+" MB":(e/1073741824).toFixed(1)+" GB",_t=e=>e[0].toLowerCase()+e.slice(1),ct=e=>e[0].toUpperCase()+e.slice(1),Xo=e=>/[A-Z]/.test(e)?e.replace(/(.{1})([A-Z])/g,"$1-$2").toLowerCase():e,_=e=>/[_-]/.test(_t(e))?e.replace(/([_-]+).{1}/g,(t,o)=>t[o.length].toUpperCase()):e,zo=e=>j([].slice.call(e)),G=(e,t)=>{let o=typeof e=="string"?$().querySelectorAll(e):e,r=o.length;if(r===0)return;let n=-1;for(;++n<r&&t(o[n],n)!==!1;);},Yt=e=>{for(let t in e)delete e[t];},ce=e=>new DOMParser().parseFromString(e,"text/html"),le=e=>(e||document).documentElement.outerHTML,Kt=e=>{let t=e.indexOf("<title");if(t===-1||e.slice(0,t).indexOf("<svg")>-1)return A;let o=e.indexOf(">",t)+1,r=e.indexOf("</title",o);return r===-1?A:ms(e.slice(o,r).trim())},_o=(e,t)=>t.querySelector(e),Yo=(e,t)=>[].slice.call(t.querySelectorAll(e))||[],lt=(e=>{let t=r=>new Promise(n=>n(r())),o=async(r=2,n=200)=>{for(;e.length>0;){for(let i of e.splice(0,r))await t(i);await new Promise(i=>setTimeout(i,n));}};return (...r)=>{r.forEach(n=>e.push(n)),B(()=>o(),50);}})([]);var Ko=()=>{if(s.patched)return;s.patched=!0;let e=Element.prototype.setAttribute,t=document.createElement("i");Element.prototype.setAttribute=function(r,n){if(r.indexOf("@")<0)return e.call(this,r,n);t.innerHTML=`<i ${r}="${n}"></i>`;let i=t.firstElementChild.getAttributeNode(r);t.firstElementChild.removeAttributeNode(i),this.setAttributeNode(i);};};var fe=(()=>{let e=[],t=document.createElement("div"),o=null,r,n=null,i=({bgColor:g,barHeight:Ce,speed:he,easing:_r})=>{t.style.cssText=`pointer-events:none;background:${g};height:${Ce};position:fixed;display:block;z-index:2147483647;top:0;left:0;width:100%;will-change:opacity,transform;transition:${he}ms ${_r};`;},a=g=>(-1+g)*100,c=(g,Ce,he)=>Math.max(Ce,Math.min(he,g)),l=()=>n||(t.style.transform=`translateX(${a(o||0)}%)`,n=$().appendChild(t),t),f=()=>{let g=$();g.contains(n)?n.animate({opacity:["1","0"]},{easing:"ease-out",duration:100}).onfinish=()=>{g.removeChild(n),n=null;}:n=null;},m=()=>{let g=e.shift();g&&g(m);},E=g=>{e.push(g),e.length===1&&m();},d=g=>{g=c(g,s.config.progress.minimum,1),o=g===1?null:g;let Ce=l();E(he=>{Ce.style.transform=`translateX(${a(g)}%)`,setTimeout(()=>(g===1&&f(),he()),s.config.progress.speed*(g===1?2:1));});},F=g=>{if(!o)return Qe();o<1&&(g||(g=o<.2?.1:o<.5?.04:o<.8?.02:.005),d(c(o+g,0,.994)));},Ze=()=>setTimeout(()=>o&&(F(),Ze()),s.config.progress.trickleSpeed),Qe=g=>{s.config.progress&&(r=setTimeout(()=>{o||d(0),s.config.progress.trickle&&Ze();},g||0));};return {start:Qe,done:g=>{clearTimeout(r),!(!g&&!o)&&(F(.3+.5*Math.random()),d(1));},style:i}})();var ft=(e,t)=>{if(e.define.name!=="")return e.define.name;let o=e.name,r=t,n="define"in e&&"name"in e.define;return console.log(e.name,t),e.define.name=_t(t||o),t!==e.define.name&&(t=_(e.define.name)),n&&o!==r&&qo.test(e.define.name)&&u(`Component name "${e.define.name}" is invalid and converted to: ${t}`),t},Q=(e,t=!1)=>{for(let o in e){let r=e[o],n=t?o:ft(r,o);s.registry.has(n)||(s.registry.set(n,r),x(`Component ${r.name} registered using id: ${n}`));}s.config.components||(s.config.components=!0);};function C(e,...t){let o=e==="cache",r=e==="disconnect"?null:t.length===1?t[0]:t.shift();o&&(t[0]=ce(t[0]));let n=!0;return H(i=>{let a=i.apply(r,t);o?a instanceof Document?n=a.documentElement.outerHTML:typeof n!="string"&&(n=a!==!1):n=a!==!1;},s.events[e]||[]),n}var Jo=(e,t,o)=>(e in s.events||(s.events[e]=[]),s.events[e].push(o?t.bind(o):t)-1),Zo=(e,t)=>{if(e in s.events){let o=s.events[e];if(o&&typeof t=="number")o.splice(t,1),x(`Removed ${e} event listener (id: ${t})`),o.length===0&&delete s.events[e];else {let r=[];if(o&&t)for(let n=0,i=o.length;n<i;n++)o[n]!==t?r.push(o[n]):e!=="x"&&x(`Removed ${e} event listener (id: ${n})`);r.length?s.events[e]=r:delete s.events[e];}}else u(`Unknown or invalid event listener: ${e}`);};var mt=(e,t)=>{let o=t(e);if(o===!1)return;o===1&&(e=e.nextSibling);let r,n;for(e.firstElementChild&&(n=0,r=e.children[n]);r;)r&&mt(r,t),r=e.children[++n];};var Qo=(e,t)=>`on${e}`in t?!0:(T(`Invalid event name "${e}" provided`,t),!1),er=(e,t)=>{let o=e[t.method];return function(n){t.attrs&&(n.attrs=t.attrs),o.call(e,n);}},Re=(e,t)=>{t.attached&&(t.listener.abort(),t.listener=new AbortController,t.options.signal=t.listener.signal,t.attached=!1,x([`Detached ${t.key} ${t.eventName} event from ${t.method}() method in component`,`${e.scope.define.name}: ${e.scope.key}`],"#D1A9FF"));},pt=(e,t,o)=>{if(t.attached)return;if(!(t.method in e)){u(`Undefined callback method: ${e.scope.define.name}.${t.method}()`);return}let r=o?J(t,"dom",o).dom:t.dom;tr(r.attributes,t),t.isWindow?Qo(t.eventName,window)&&addEventListener(t.eventName,er(e,t)):Qo(t.eventName,r)&&r.addEventListener(t.eventName,er(e,t),t.options),t.attached=!0,x([`Attached ${t.key} ${t.eventName} event to ${t.method}() method in component`,`${e.scope.define.name}: ${e.scope.key}`],"#7b97ca");};var De=(e,t,o=!1,r=[])=>{let n=t.length,i=n===1?t[0].split(","):t,a=-1;for(;++a<n;){let c=r[r.push(e(i[a]))-1];if(o&&!c)return !1}return o||r},ke={toNode(e){return e},getAttr(e,...t){return t.length===1?e.getAttribute(t[0]):t.reduce((o,r)=>Object.assign(o,{[r]:e.getAttribute(o)}),p())},setAttr(e,...t){return typeof t[0]=="object"?Object.keys(t[0]).forEach(o=>e.setAttribute(o,t[0][o])):e.setAttribute(t[0],t[1]),this},hasAttr(e,...t){return De(o=>e.hasAttribute(o),t,!0)},removeAttr(e,...t){return De(o=>!e.hasAttribute(o)||e.removeAttribute(o),t),this},addClass(e,...t){return De(o=>e.classList.add(o),t),this},hasClass(e,...t){return De(o=>e.classList.contains(o),t,!0)},removeClass(e,...t){return De(o=>e.classList.remove(o),t),this},toggleClass(e,t,...o){return this.hasClass(e,t)?this.removeClass(e,t).addClass(e,...o):this.addClass(e,t),this},watch(){},update(){}};var rr=e=>{let{scope:t,dom:o}=e;e.state=new Proxy(t.state,{get:Reflect.get,set(n,i,a,c){if(i in t.binds){let l=t.binds[i],f=typeof a=="object"||Array.isArray(a)?JSON.stringify(a):`${a}`;for(let m in l)l[m].live&&(l[m].value=f,G(l[m].selector,E=>{E.innerText=f;}));}return Reflect.set(n,i,a,c)}});let r=s.config.schema+t.instanceOf;if(He(t.state))for(let n in t.define.state)t.state[n]=Gt(t.define.state[n]);else for(let n in t.define.state){let i=t.define.state[n];if(!(n in t.state)){t.state[n]=Gt(i);continue}let a=`has${ct(n)}`,c=`${r}:${Xo(n)}`;o.hasAttribute(c)||(c=`${r}:${n}`);let l=o.getAttribute(c),f=l!==null&&l!=="";if(a in t.state||Reflect.set(t.state,a,f),typeof l=="string"&&l.startsWith("window.")){let m=l.slice(7);m in window?t.state[n]=window[m]:u(`Property "windowProp" does not exist on window: ${s.qs.s}-${c}="${l}"`);}else if(Array.isArray(i))t.state[n]=f?z(l):i;else {let m=typeof i;if(m==="object")t.state[n]=f?z(l):i;else if(m==="number")t.state[n]=f?+l:i;else if(m==="boolean")t.state[n]=f?l==="true":i;else if(m==="string")t.state[n]=f?l:i;else switch(i){case String:t.state[n]=f?l:"";break;case Boolean:t.state[n]=l==="true"||!1;break;case Number:t.state[n]=l?Number(l):0;break;case Object:t.state[n]=f?z(l):{};break;case Array:t.state[n]=f?z(l):[];break}}}},sr=(e,t)=>{let o=Reflect.getPrototypeOf(t),r=Reflect.getOwnPropertyDescriptor(o,e);if(r&&r.get)return Reflect.get(o,e,t);let n=Reflect.get(t,e);return typeof n=="function"?n.bind(t):n},or=e=>e?new Proxy(e,{set:(t,o,r,n)=>o in e?Reflect.set(e,o,r):Reflect.set(t,o,r,n),get:(t,o,r)=>o in e?sr(o,e):o in ke?(...n)=>ke[o](e,...n):Reflect.get(t,o,r)}):null,nr=({dom:e,name:t})=>new Proxy(()=>e.nodes,{get(o,r,n){let{node:i}=e;return r===Symbol.toPrimitive?(T(`Sugar Error: Use this.${t}.toNode() for raw element: ${`this.${t}`}`),()=>""):r in ke?(...a)=>ke[r](i,...a):r in i?sr(r,i):Reflect.get(o,r,n)},set(o,r,n,i){let{node:a}=e;return r in a?Reflect.set(a,r,n):Reflect.set(o,r,n,i)},apply(o,r,n){let{nodes:i}=e;if(n.length===2)return i.reduce(n[1],n[0]);let a=i.length,c=n[0],l=typeof n[0];if(l==="number")return or(i[c]);if(l==="string")return i.filter(f=>f.matches(c));if(l==="function"){let f=-1,m=Array(a);for(;++f<a;)m[f]=c(or(i[f]),f);return m}return Reflect.apply(o,r,n)}});me.scopes=P();function me(e){var t;return t=class{get root(){return Mo()}get dom(){return this.scope.dom}set dom(o){me.scopes.get(this.ref).dom=o;}constructor(o){Reflect.defineProperty(this,"scope",{get(){return me.scopes.get(o)}}),Reflect.defineProperty(this,"ref",{value:o,configurable:!1,enumerable:!1,writable:!1}),rr(this);}},t.define=Object.assign({name:"",merge:!1,sugar:!1,state:{},nodes:[]},e),t}var Ve={};Qr(Ve,{connect:()=>pe,disconnect:()=>je,hargs:()=>dt,hook:()=>ht,mount:()=>yt,teardown:()=>to});var ar=()=>B(()=>y.store=void 0),Jt=(e,t)=>{for(let o of t){if(!s.maps[o])continue;let r=s.maps[o],n=o.charCodeAt(0);if(n===99)s.mounted.add(r.scope.key),r.dom=e,r.scope.status=2,x(`Component ${r.scope.define.name} mounted: ${r.scope.key}`,"#6DD093");else if(n===101)pt(r,r.scope.events[o],e);else if(n===110)for(let i in r.scope.nodes)++r.scope.nodes[i].live;else if(n===98){for(let i in r.scope.binds)if(o in r.scope.binds[i]){e.innerText=r.scope.binds[i][o].value,r.scope.binds[i][o].live=!0;break}}}},Ie=(e,t)=>{for(let o of t){if(!s.maps[o])continue;let r=s.maps[o],n=o.charCodeAt(0);if(n===99){r.scope.hooks.unmount===2&&r.unmount(dt()),s.mounted.delete(r.scope.key),r.scope.define.merge&&(r.scope.snapshot=e.innerHTML,x(`Component ${r.scope.define.name} snapshot: ${r.scope.key}`));for(let i in r.scope.nodes)r.scope.nodes[i].live=0;for(let i in r.scope.binds)for(let a in r.scope.binds[i])r.scope.binds[i][a].live=!1;for(let i in r.scope.events)Re(r,r.scope.events[i]);r.scope.status=5,x(`Component ${r.scope.define.name} unmounted: ${r.scope.key}`,"#CAAF7C");}else if(n===101)Re(r,r.scope.events[o]);else if(n===110)for(let i in r.scope.nodes)--r.scope.nodes[i].live;else if(n===98){for(let i in r.scope.binds)if(o in r.scope.binds[i]){r.scope.binds[i][o].live=!1;break}}}},Ue=e=>{if(e.nodeType!==1&&e.nodeType!==11)return;let t=e.getAttribute(s.qs.e);t&&Ie(e,t.split(","));},cr=e=>{let t=e.getAttribute(s.qs.e);t?Jt(e,t.split(",")):te(e.attributes)&&(y.store?y.store.l=e:y.store=We(e),ee(e,y.store));},lr=e=>{y.store?y.store.l=e:y.store=We(e),ee(e,y.store,!1);},fr=(e,t,o,r)=>{o&&(o=o.split(",")),r&&(r=r.split(",")),o&&r?(Ie(e,o),Jt(e,r)):!o&&r?Jt(e,r):(y.store?y.store.l=e:y.store=We(t),o&&!r&&Ie(e,o),te(t.attributes)&&ee(e,y.store));};var pr=(e,t)=>e.setAttribute(s.qs.e,e.hasAttribute(s.qs.e)?`${e.getAttribute(s.qs.e)},${t.shift()}`:t.shift()),Ee=(e,t)=>{Reflect.set(s.snaps,e,t)?x(`Snapshot ${s.page.key} updated for: ${s.page.snap}`,"#6DD093"):u(`Snapshot ${s.page.key} could not be updated for: ${s.page.snap}`);},Fe=e=>(y.snaps.push([e,P()]),e),ur=(e,t)=>y.refs.has(e)?y.refs.get(e).push(t):y.refs.set(e,[t]),gt=(e,t)=>lt(()=>{for(;y.snaps.length>0;){let[o,r]=y.snaps.shift();for(let[n,i]of r)o.matches(n)&&pr(o,i),o.querySelectorAll(n).forEach(a=>pr(a,i));r.clear();}Ee(t,e.documentElement.outerHTML);});var eo=(e,t)=>B(()=>{let r=Y(e.snap).querySelector(`[${s.qs.e}="${e.ref}"]`);r?(r.innerHTML=e.snapshot,Ee(e.snap,r.ownerDocument.documentElement.outerHTML)):u(`Component snapshot merge failed: ${e.instanceOf} (${t})`);}),dr=(e,t)=>{let{page:o,dom:r}=gr(s.page.key),n=e.charCodeAt(0)===114?"removed":"appended";r.head.contains(t)?(r.head[e](t),Ee(o.snap,r.documentElement.outerHTML),x(`Snapshot record was updated, ${n} ${t.nodeName.toLowerCase()} from <head>`)):u("Node does not exist in the snapshot record, snapshot morph skipped",t);};var dt=()=>p(p(s.page)),to=()=>{for(let e in s.maps)delete s.maps[e];for(let e of s.instances.values())for(let t in e.scope.events)Re(e,e.scope.events[t]);s.instances.clear(),s.mounted.clear(),k("Component instances were disconnected");},yt=e=>{let t=dt(),o=[];for(let[r,n,i]of e){let a=s.instances.get(r),c=a.scope.status===4?"unmount":"onmount";a.scope.snap||(a.scope.snap=s.page.snap);let l=async()=>{try{i&&a.scope.status===1?(await a[n](t),await a[i](t)):a.scope.status===4?a.scope.define.merge&&eo(a.scope,r):await a[n](t),a.scope.status=a.scope.status===4?5:3,a.scope.hooks.connect===2&&(a.scope.hooks.connect=3);}catch(f){return u(`Component to failed to ${c}: ${a.scope.instanceOf} (${r})`,f),Promise.reject(r)}};o.push(nt().then(l));}return Promise.allSettled(o)},ht=()=>{if(s.mounted.size===0&&s.instances.size===0&&s.registry.size>0)return Ge();let e=[];for(let t of s.mounted){if(!s.instances.has(t))continue;let o=s.instances.get(t);if(o.scope.status!==3&&o.scope.status!==5){let r=o.scope.status===4,n=r?"unmount":"onmount";n in o?n==="onmount"&&"connect"in o&&o.scope.hooks.connect===2?e.push([t,"connect",n]):e.push([t,n]):r&&(o.scope.define.merge&&eo(o.scope,t),o.scope.status=5);}}e.length>0&&yt(e).catch(t=>{let o=s.instances.get(t);o.scope.status=5,s.mounted.delete(t);});},pe=()=>{s.registry.size===0||s.observe.components||(s.page.type===0?Ge():y.store?Be(y.store).then(ht).then(ar):ht(),s.observe.components=!0);},je=()=>{s.observe.components&&(ht(),s.observe.components=!1);};var ps=(e,t)=>{e.hooks=p(),H(o=>{e.hooks[o]=o in t?2:1;},["connect","onmount","unmount","onmedia"]);},us=(e,t,o)=>(r,n)=>{if(t===!1||o&&n.status===2){s.mounted.add(n.key),s.instances.set(n.key,r),x(`Component "${n.instanceOf}" connected: ${n.key}`,"#F48FB1");let i=-1;n.hooks.connect===2&&(i=e.push([n.key,"connect"])-1,n.status=1),n.hooks.onmount===2&&(i=(i>-1?e[i].push("onmount"):e.push([n.key,"onmount"]))-1),i<0&&(n.status=3);}},hr=(e,t,o)=>{for(let r in e.events){let n=e.events[r];r in t.scope.events||(s.maps[r]=t.ref,t.scope.events[r]=n),o!==null&&e.status===3&&(s.maps[r]=e.key,t.scope.events[r]=e.events[r]),pt(t,e.events[r]);}},yr=(e,t)=>{for(let o in e){let r=e[o],n=`has${ct(o)}`;if(o in t.scope.nodes||(s.maps[o]=t.ref,t.scope.nodes[o]=r),n in t){o in t.scope.nodes&&++t.scope.nodes[o].live;return}let i=()=>r.live>0,a=()=>_o(r.selector,r.isChild?t.dom:$()),c=()=>Yo(r.selector,r.isChild?t.dom:$());Object.defineProperty(t,n,{get:i}),t.scope.define.sugar?(Object.defineProperties(r.dom,{node:{get:a},nodes:{get:c}}),t[o]=nr(r)):Object.defineProperties(t,{[`${o}Node`]:{get:a},[`${o}Nodes`]:{get:c}});}},ds=(e,t,o)=>{let r=o||s.page.type===4,n=us(e,o,r);return (i,a)=>{if(a)yr(i.nodes,a),hr(i,a,o);else {i.define=p();let c=s.registry.get(i.instanceOf),l=Object.defineProperty(i,"define",{get:()=>c.define});me.scopes.set(i.key,l);let f=new c(i.key);ps(i,f),yr(i.nodes,f),hr(i,f,o),n(f,i);}}},Be=(e,t)=>{let{t:o,i:r,l:n}=e,i=[],a=Er(),c=ds(i,a,n!==null);for(let l in o){if(!s.registry.has(l)&&!a.has(l)){u(`Component does not exist in registry: ${l}`,o[l]);continue}for(let f of o[l]){if(f.instanceOf==null)if(l in r)f.instanceOf=r[l];else continue;if(a.has(l))for(let m of a.get(l))m.scope.instanceOf===l&&c(f,m);else c(f);}}return B(()=>[a.clear()]),(s.page.type===0&&t||t)&&gt(t,s.page.snap),i.length>0?yt(i):Promise.resolve()};var ee=(e,t,o=!0)=>{o&&!te(e.attributes)||(e.hasAttribute(s.qs.s)?vs(e,e.getAttribute(s.qs.s),t):xr(e,t,null,null));},gs=(e,t)=>{let o=e.trim().replace(/\s+/," ").split(/[|, ]/);for(let r=0,n=0,i=o.length;r<i;r++)o[r]!==""&&((n=r+2)<i&&o[r+1]==="as"?(t(_(o[r]),_(o[n])),r=n):t(_(o[r]),null));},tr=(e,t)=>{let o=e.length,r=0;for(;++r<o;){let{name:n,value:i}=e[r];if(!s.qs.N.test(n)||n.startsWith(s.qs.u)||!i)continue;let a=n.slice(s.config.schema.length).split(":").pop();t.attrs===null&&(t.attrs=p()),a in t.attrs||(t.attrs[a]=hs(i));}},te=e=>{if(typeof e=="string")return e.indexOf("@")>-1||e===s.qs.s||e===s.qs.m||e===s.qs.d;for(let t=e.length-1;t>=0;t--)if(te(e[t].name))return !0;return !1},Et=(e,t)=>(e.status===2||e.status===3)&&e.dom?e.dom.contains(t):!1;var ro=e=>Wo(e.replace(/\s \./g,".")).replace(/\s+/g," ").trim().split(/[ ,]/),hs=e=>{if(Pe.test(e))return e==="NaN"?NaN:+e;if(Me.test(e))return e==="true";let t=e.charCodeAt(0);return t===123||t===91?z(e):e},We=(e=null,t=null)=>{let o=p();return o.i=p(),o.t=p(),o.A=null,o.P=e?p():null,o.l=e,o.O=t,o},Xe=(e,t,o,r)=>(o||(o=e.getAttribute(t)),`${e.nodeName.toLowerCase()}[${t}${r?"*=":"="}"${o}"]`),xt=(e,{t,i:o})=>e in o?qe(t[o[e]]):e in t?qe(t[e]):(t[e]=[oo([e])])[0],vt=(e,t,o,r)=>{s.maps[o]=t;let n=e.getAttribute(s.qs.e);return e.setAttribute(s.qs.e,n?`${n},${o}`:o),r&&ur(r,o),o},oo=([e,t=null],o,r)=>{let n=p();if(n.key=Z(),n.ref=`c.${n.key}`,n.status=5,n.state=p(),n.nodes=p(),n.binds=p(),n.events=p(),o&&(n.snap=null,n.status=2,n.inFragment=Tt(o),n.alias=t||null,n.dom=o,vt(o,n.key,n.ref,Xe(o,s.qs.s))),s.registry.has(e))if(n.instanceOf=e,n.alias)if(s.registry.has(n.alias))T(`Component alias "${n.alias}" matched a component identifier in the registry`);else if(n.alias in r.t){for(let{events:i,nodes:a,binds:c}of r.t[n.alias]){if("events"in n)for(let l in i)n.events[l]=i[l],s.maps[l]=n.key;if("nodes"in n)for(let l in a)n.nodes[l]=a[l],s.maps[l]=n.key;if("binds"in n)for(let l in c)n.binds[l]=c[l],s.maps[l]=n.key;}delete r.t[n.alias];}else r.i[n.alias]=e;else n.alias=null;else e?n.alias=e:n.instanceOf=null,n.status===2&&(r.i[n.alias]=null);return n},ys=(e,t,o,r)=>{let n=t.slice(s.config.schema.length),i=n.startsWith("window:"),a=o.indexOf("{"),c=o.trim().split(a>-1?new RegExp("(?<=[$_\\w}])\\s+(?=[$_\\w])"):/\s+/);for(let l=0,f=c.length;l<f;l++){let m=c[l],E=new AbortController,d=p();d.key=`e.${Z()}`,d.isWindow=i,d.eventName=i?n.slice(7):n,d.attached=!1,d.selector=Xe(e,Fo(t),m,!0),d.attrs=null,d.options={signal:E.signal};let F=m;if(a>-1){let g=m.slice(a,m.lastIndexOf("}",a)).match(/(passive|once|capture)/g);g!==null&&(d.options.once=g.indexOf("once")>-1,d.options.passive=g.indexOf("passive")>-1,d.options.capture=g.indexOf("capture")>-1),F=m.slice(0,a);}let[Ze,Qe]=ro(F)[0].split("."),et=xt(Ze,r);d.listener=E,d.method=Qe.trim(),d.isChild=Et(et,e),J(d,"dom",e,!0),vt(e,et.key,d.key,d.selector),et.events[d.key]=d;}},Es=(e,t,o)=>{let r=ro(t);for(let n of r){let[i,a]=n.split("."),c=xt(i,o);a in c.nodes?(c.nodes[a].live++,c.nodes[a].isChild=Et(c,e)):c.nodes[a]=p({name:a,selector:`[${s.qs.m}*="${t}"]`,dom:p(),key:`c.${c.key}`,live:1,isChild:Et(c,e)});}},xs=(e,t,o)=>{var r;for(let n of ro(t)){let[i,a]=n.split("."),c=xt(i,o),l=`[${s.qs.d}="${t}"]`,f=vt(e,c.key,`b.${Z()}`,`${e.nodeName.toLowerCase()}${l}`);(r=c.binds)[a]||(r[a]=p()),c.binds[a][f]=p({key:f,stateKey:a,selector:l,value:e.innerText,live:!0,stateAttr:`${s.config.schema}${i}:${a}`,isChild:Et(c,e)}),Object.defineProperty(c.binds[a][f],"dom",{get:()=>e});}},xr=(e,t,o,r)=>{o===null&&r===null&&(t.A=Z());for(let n=e.attributes.length-1;n>=0;n--){let{name:i,value:a}=e.attributes[n];if(o){let c=`${s.config.schema}${o}:`;r&&!i.startsWith(c)&&(c=`${s.config.schema}${r}:`),i.startsWith(c)&&(xt(o,t).state[_(i.slice(c.length))]=a);}i.indexOf("@")>-1?ys(e,i,a,t):i===s.qs.d?xs(e,a,t):i===s.qs.m&&Es(e,a,t);}},vs=(e,t,o)=>{gs(t,(r,n)=>{if(!s.registry.has(r))u(`Component does not exist in registry: ${r}`);else {let i;r in o.t?(i=qe(o.t[r]),i.status===5?(i.status=2,i.inFragment=Tt(e),i.dom=e,vt(e,i.key,i.ref,Xe(e,s.qs.s))):o.t[r].push(oo([r,n],e,o))):o.t[r]=[oo([r,n],e,o)],i=qe(o.t[r]),n?o.i[n]=r:i.alias&&!(i.alias in o.i)&&(s.registry.has(i.alias)?(u(`Alias cannot use a component identifier: ${i.instanceOf} as ${i.alias}`),i.alias=null):o.i[i.alias]=r),xr(e,o,r,i.alias);}});},Ge=(e,t=null)=>{let o=We();if(!e&&!t){let{ownerDocument:r}=Fe(s.snapDom.body);mt($(),n=>ee(n,o)),He(o.t)||Be(o,r);}else if(t){let r;s.snapDom.querySelector(t)?r=Fe(s.snapDom.querySelector(t)).ownerDocument:u(`Cannot find element in snapshot using selector: ${t}`),mt(e,i=>ee(i,o)),He(o.t)||Be(o,r);}else return e instanceof Set?(e.forEach(r=>ee(r,o)),e.clear(),o):(ee(e,o),o)};var Tt=e=>{for(let[t,o]of s.fragments)if(t===e.id||o.contains(e))return !0;return !1},Nt=()=>{s.fragments.clear();let e,t,o,r=$();if(s.page.target.length>0?(t=s.qs.f,e=s.page.target.join(),o=zo(r.querySelectorAll(`[id][${s.qs.s}]`))):(t=s.qs.h,e=s.config.fragments.length===1&&s.config.fragments[0]==="body"?s.qs.y:`${s.config.fragments.join()},${s.qs.y}`),G(e,n=>{if(o){for(let i of o)if(n.contains(i)){o.delete(i);break}}if(n.hasAttribute(t)){let i=n.getAttribute(t).trim();n.id!==A&&(i==="true"||i===A)?s.fragments.set(`#${n.id}`,n):s.fragments.set(Xe(n,t,i),n);}else s.fragments.set(`#${n.id}`,n);}),o&&o.size>0){for(let n of o)s.fragments.set(`#${n.id}`,n),s.page.target.push(`#${n.id}`),y.marks.add(n.id);o.clear();}oe("fragments",[...s.fragments.keys()]);},vr=e=>{e.type===6||e.selector==="body"||e.selector===null||B(()=>{let t=Y(e.snap),o=t.body.querySelectorAll(s.qs.E),r=$().querySelectorAll(s.qs.E);G(o,(n,i)=>{if(Tt(n))u("The fragment or target is a decedent of an element which morphs",n);else {if(!n.hasAttribute("id"))n.setAttribute("id",`t.${Z()}`),r&&r[i].setAttribute("id",`t.${Z()}`);else if(n.id.startsWith("t."))return;e.target.push(n.id);}}),Ee(e.snap,t.documentElement.outerHTML);});};var w=e=>{let t=at(e);return e.ts=it(),e.target=Xt(e),e.selector=Se(e.target),s.config.cache&&(t("cache")||(e.cache=s.config.cache),e.snap||(e.snap=zt())),s.config.hover!==!1&&e.type===10&&(e.threshold||(e.threshold=s.config.hover.threshold)),s.config.proximity!==!1&&e.type===12&&(e.proximity||(e.proximity=s.config.proximity.distance),e.threshold||(e.threshold=s.config.proximity.threshold)),s.config.progress&&(e.progress||(e.progress=s.config.progress.threshold)),t("history")||(e.history=!0),e.scrollY||(e.scrollY=0),e.scrollX||(e.scrollX=0),e.fragments||(e.fragments=s.config.fragments),e.visits||(e.visits=0),e.location||(e.location=ve(e.key)),s.pages[e.key]=e,s.pages[e.key]},Tr=e=>{let t=p(Ao(No({},e),{target:[],selector:null,cache:s.config.cache,history:!0,scrollX:0,scrollY:0,fragments:s.config.fragments})),o=s.config.hover,r=s.config.proximity;return o&&(t.threshold=o.threshold),r&&(t.proximity=r.distance,t.threshold=r.threshold),s.config.progress&&(t.progress=s.config.progress.threshold),t},oe=(e,t,o=s.history.key)=>{o in s.pages&&e in s.pages[o]&&(e==="location"?s.pages[o][e]=Object.assign(s.pages[e][o],t):e==="target"?(s.pages[o].target=Xt(t),s.pages[o].selector=Se(s.pages[o].target)):s.pages[o][e]=t);},xe=(e,t)=>{e.type>5&&e.type>9&&(e.type=1),e.title=Kt(t);let o=C("cache",e,t),r=typeof o=="string"?o:t;return !s.config.cache||o===!1?e:e.type!==0&&!R(e,"snap")?re(e,r):(s.pages[e.key]=e,s.snaps[e.snap]=r,vr(e),e)},re=(e,t=null)=>{let o=e.key in s.pages?s.pages[e.key]:w(e);return t&&(s.snaps[o.snap]=t,e.title=Kt(t)),Object.assign(o,e)},gr=e=>{if(!e){if(s.history===null){u("Missing history state reference, page cannot be returned");return}e=s.history.key;}if(e in s.pages)return {get page(){return s.pages[e]},get dom(){return ce(s.snaps[s.pages[e].snap])}};T(`No record exists: ${e}`);},Y=e=>{let t=typeof e=="number"?e:typeof e=="string"&&e.charCodeAt(0)===47?s.pages[e].snap:s.page.snap;return ce(s.snaps[t])},Er=()=>{let e=P();for(let t of s.mounted){if(!s.instances.has(t))continue;let o=s.instances.get(t),{scope:r}=o;(r.status===2||r.status===3)&&(r.alias!==null&&(e.has(r.alias)?e.get(r.alias).push(o):e.set(r.alias,[o])),e.has(r.instanceOf)?e.get(r.instanceOf).push(o):e.set(r.instanceOf,[o]));}return e},br=e=>{if(!e){if(s.history===null){u("Missing history state reference, page cannot be returned");return}e=s.history.key;}if(R(s.pages,e))return s.pages[e];T(`No page record exists for: ${e}`);},q=e=>R(s.pages,e)&&R(s.pages[e],"snap")&&R(s.snaps,s.pages[e].snap)&&typeof s.snaps[s.pages[e].snap]=="string";var K=e=>{e?typeof e=="string"?(delete s.snaps[s.pages[e].snap],delete s.pages[e]):Array.isArray(e)&&H(t=>{delete s.snaps[s.pages[t].snap],delete s.pages[t];},e):(Yt(s.snaps),Yt(s.pages));};var D=ae.replace(/(?:https?:)?(?:\/\/(?:www\.)?|(?:www\.))/,A),no=(e,t)=>{let o=t?Tr(t):p(),r=e.getAttributeNames();for(let n=0,i=r.length;n<i;n++){let a=r[n];if(a.startsWith(s.qs.u)){R(o,"data")||(o.data=p());let c=_(a.slice(s.qs.u.length)),l=e.getAttribute(a).trim();Pe.test(l)?o.data[c]=l==="NaN"?NaN:+l:Me.test(l)?o.data[c]=l==="true":l.charCodeAt(0)===123||l.charCodeAt(0)===91?o.data[c]=z(a,l):o.data[c]=l;}else {if(!s.qs.C.test(a))continue;let c=e.getAttribute(a).trim();if(a==="href")o.rev=S(location),t||(o.location=ve(c),o.key=S(o.location));else {let l=a.slice(a.lastIndexOf("-")+1),f=c.replace(Ho,A).trim();if(l==="target")o[l]=f==="true"?[]:f!==A?Uo(f):[],o.selector=Se(o[l]);else if(ko.test(f)){let m=f.match(/\[?[^,'"[\]()\s]+\]?/g);o[l]=So.test(l)?m.reduce(Bo(2),[]):m;}else if(l==="position")if(Vt.test(f)){let m=f.match(Vt);o[`scroll${m[0].toUpperCase()}`]=+m[1],m.length===4&&(o[`scroll${m[2].toUpperCase()}`]=+m[3]);}else u(`Invalid ${a} value, expected: y:number or x:number`,e);else l==="scroll"?rt.test(f)?o.scrollY=+f:u(`Invalid ${a} value, expected: number`,e):Me.test(f)&&!Ro.test(a)?o[l]=f==="true":Pe.test(f)?o[l]=+f:(l==="history"&&f!=="push"&&f!=="replace"&&u(`Invalid ${a} value, expected: false, push or replace`,e),o[l]=f);}}}return o},Te=e=>{let t=p();if(e.length===1&&e.charCodeAt(0)===47)return t.pathname=e,t.hash=A,t.search=A,t;let r=e.indexOf("#");r>=0?(t.hash=e.slice(r),e=e.slice(0,r)):t.hash=A;let n=e.indexOf("?");return n>=0?(t.search=e.slice(n),e=e.slice(0,n)):t.search=A,t.pathname=e,t},At=(e,t)=>{let o=e.indexOf("/",t);if(o>t){let n=e.indexOf("#",o);return n<0?e.slice(o):e.slice(o,n)}let r=e.indexOf("?",t);if(r>t){let n=e.indexOf("#",r);return n<0?e.slice(r):e.slice(r,n)}return e.length-t===D.length?"/":null},so=e=>{let t=e.startsWith("www.")?e.slice(4):e,o=t.indexOf("/");if(o>=0){let r=t.slice(o);if(t.slice(0,o)===D)return r.length>0?Te(r):Te("/")}else {let r=t.search(/[?#]/);if(r>=0){if(t.slice(0,r)===D)return Te("/"+t.slice(r))}else if(t===D)return Te("/")}return null},Ts=e=>e.startsWith("http:")||e.startsWith("https:")?1:e.startsWith("//")?2:e.startsWith("www.")?3:0,io=e=>{if(typeof e!="string"||e.length===0)return !1;if(e.charCodeAt(0)===47)return e.charCodeAt(1)!==47?!0:e.startsWith("www.",2)?e.startsWith(D,6):e.startsWith(D,2);if(e.charCodeAt(0)===63)return !0;if(e.startsWith("www."))return e.startsWith(D,4);if(e.startsWith("http")){let t=e.indexOf("/",4)+2;return e.startsWith("www.",t)?e.startsWith(D,t+4):e.startsWith(D,t)}return !1},bs=e=>e.charCodeAt(0)===47?e.charCodeAt(1)!==47?Te(e):so(e.slice(2)):e.charCodeAt(0)===63?Te(location.pathname+e):e.startsWith("https:")||e.startsWith("http:")?so(e.slice(e.indexOf("/",4)+2)):e.startsWith("www.")?so(e):null,S=e=>{if(typeof e=="object")return e.pathname+e.search;if(e===A||e==="/")return "/";let t=Ts(e);if(t===1){let o=e.charCodeAt(4)===115?8:7,r=e.startsWith("www.",o)?o+4:o;return e.startsWith(D,r)?At(e,r):null}if(t===2){let o=e.startsWith("www.",2)?6:2;return e.startsWith(D,o)?At(e,o):null}return t===3?e.startsWith(D,4)?At(e,4):null:e.startsWith(D,0)?At(e,0):e.charCodeAt(0)===47?e:null},Nr=({pathname:e,search:t,hash:o}=location)=>p({hostname:D,origin:ae,pathname:e,hash:o,search:t}),ve=e=>{if(e===A)return Nr();let t=bs(e);return t===null&&u(`Invalid pathname: ${e}`),t.origin=ae,t.hostname=D,t},L=(e,t=6)=>{if(e instanceof Element){let r=no(e);return r.type=t||6,r}let o=p();return e===0?(o.location=Nr(),o.key=o.rev=S(o.location),o.type=e,o.visits=1,s.index=o.key):t===7||t===4?(o.location=ve(e),o.key=o.rev=S(o.location),o.type=t):(o.rev=location.pathname+location.search,o.location=ve(typeof e=="string"?e:o.rev),o.key=S(o.location),o.type=t),o};var ze=(e,{method:t="GET",body:o=null,headers:r=[["spx-http","href"]],type:n="text"}={})=>new Promise((i,a)=>{let c=new h;c.key=e,c.responseType=n,c.open(t,e,!0);for(let[l,f]of r)c.setRequestHeader(l,f);c.onloadstart=function(){h.o.set(this.key,c);},c.onload=function(){i(this.response);},c.onerror=function(){a(this.statusText);},c.onabort=function(){delete h.r[this.key],h.c.delete(this.key),h.o.delete(this.key);},c.onloadend=function(l){h.o.delete(this.key),s.memory.bytes=s.memory.bytes+l.loaded,s.memory.visits=s.memory.visits+1;},c.send(o);}),$t=e=>e in h.r?(clearTimeout(h.r[e]),delete h.r[e]):!0,Ct=(e,t,o)=>{e in h.r||q(e)||(h.r[e]=setTimeout(t,o));};var ao=e=>{for(let[t,o]of h.o)e!==t&&(o.abort(),u(`Pending request aborted: ${t}`));},Ar=e=>{if(s.config.preload!==null){if(Array.isArray(s.config.preload)){let t=s.config.preload.filter(o=>{let r=L(o,3);return r.key!==o?M(w(r)):!1});return Promise.allSettled(t)}else if(typeof s.config.preload=="object"&&R(s.config.preload,e.key)){let t=s.config.preload[e.key].map(o=>M(w(L(o,3))));return Promise.allSettled(t)}}},Lt=async e=>{if(e.rev===e.key)return;let t=w(L(e.rev,4));await jo(),M(t).then(o=>{o?k(`Reverse fetch completed: ${o.rev}`):u(`Reverse fetch failed: ${e.rev}`);});},_e=async e=>{if(!h.c.has(e.key))return e;let t=await h.c.get(e.key);return h.c.delete(e.key),delete h.r[e.key],xe(e,t)},M=async e=>h.o.has(e.key)&&e.type!==7?(e.type===4&&h.o.has(e.rev)?(h.o.get(e.rev).abort(),u(`Request aborted: ${e.rev}`)):u(`Request in transit: ${e.key}`),!1):C("fetch",e)?(h.c.set(e.key,ze(e.key)),_e(e)):(u(`Request cancelled via dispatched event: ${e.key}`),!1);var wt=(e,t,o)=>{e[o]!==t[o]&&(e[o]=t[o],e[o]?e.setAttribute(o,A):e.removeAttribute(o));},$r=(e,t)=>{if(t.nodeType===11||e.nodeType===11)return;let o=t.attributes,r=e.getAttribute(s.qs.e),n=t.getAttribute(s.qs.e),i=!1,a,c,l,f,m;for(let d=o.length-1;d>=0;d--)a=o[d],c=a.name,f=a.value,l=a.namespaceURI,l?(c=a.localName||c,m=e.getAttributeNS(l,c),m!==f&&(a.prefix==="xmlns"&&(c=a.name),e.setAttributeNS(l,c,f))):(m=e.getAttribute(c),m!==f&&(e.setAttribute(c,f),!r&&!n&&!i&&(i=te(c))));let E=e.attributes;for(let d=E.length-1;d>=0;d--)E[d]!==void 0&&(a=E[d],c=a.name,f=a.value,l=a.namespaceURI,l?(c=a.localName||c,t.hasAttributeNS(l,c)||e.removeAttributeNS(l,c)):(t.hasAttribute(c)||e.removeAttribute(c),i||(i=te(c))));(r||n||i)&&fr(e,t,r,n);};var Cr=(e,t)=>{let o=e.parentNode;if(o){let r=o.nodeName.toUpperCase();r==="OPTGROUP"&&(o=o.parentNode,r=o&&o.nodeName.toUpperCase()),r==="SELECT"&&!o.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),o.selectedIndex=-1);}wt(e,t,"selected");},Lr=(e,t)=>{wt(e,t,"checked"),wt(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value");},co=(e,t)=>{let{value:o}=t;e.value!==o&&(e.value=o);let{firstChild:r}=e;if(r){let{nodeValue:n}=r;if(n===o||!o&&n===e.placeholder)return;r.nodeValue=o;}},wr=(e,t)=>{if(!t.hasAttribute("multiple")){let o=0,r=-1,n=e.firstElementChild,i,a;for(;n;)if(a=n.nodeName&&n.nodeName.toUpperCase(),a==="OPTGROUP")i=n,n=i.firstElementChild;else {if(a==="OPTION"){if(n.hasAttribute("selected")){r=o;break}o++;}n=n.nextElementSibling,!n&&i&&(n=i.nextElementSibling,i=null);}e.selectedIndex=r;}};var As=(e,t)=>!t||t==="http://www.w3.org/1999/xhtml"?document.createElement(e):document.createElementNS(t,e),Mt=(e,t)=>{if(e===t)return !0;let o=e.charCodeAt(0),r=t.charCodeAt(0);return o<=90&&r>=97?e===t.toUpperCase():r<=90&&o>=97?t===e.toUpperCase():!1},$s=(e,t)=>{switch(e.nodeName){case"INPUT":Lr(e,t);break;case"OPTION":Cr(e,t);break;case"SELECT":wr(e,t);break;case"TEXTAREA":co(e,t);break}},se=e=>e&&"getAttribute"in e?e.getAttribute("id"):void 0,Cs=(e,t)=>{let o=e.firstChild,r;for(;o;)r=o.nextSibling,t.appendChild(o),o=r;return t},Pt=(e,t,o,r=!0)=>{Ue(e),t&&t.removeChild(e),Mr(e,r,o);},Ls=e=>{e.nodeType===1&&e.hasAttribute(s.qs.m)&&lr(e);},ws=(e,t,o)=>{let r=t.firstChild,n,i,a=e.firstChild,c,l,f,m;e:for(;r;){for(n=se(r),i=r.nextSibling;a;){if(f=a.nextSibling,r.isEqualNode(a)){Ls(a),r=i,a=f;continue e}c=se(a),l=a.nodeType;let E;if(l===r.nodeType&&(l===1?(n?n!==c&&((m=o.n.get(n))?f&&f.isEqualNode(m)?E=!1:(e.insertBefore(m,a),c?o.a.add(c):Pt(a,e,o),a=m,c=se(a)):E=!1):c&&(E=!1),E=E!==!1&&Mt(a.nodeName,r.nodeName),E&&Ot(a,r,o)):(l===3||l===8)&&(E=!0,a.nodeValue!==r.nodeValue&&(a.nodeValue=r.nodeValue))),E){r=i,a=f;continue e}c?o.a.add(c):Pt(a,e,o),a=f;}n&&(m=o.n.get(n))&&Mt(m.nodeName,r.nodeName)?(e.appendChild(m),Ot(m,r,o)):(r.actualize&&(r=r.actualize(e.ownerDocument||document)),e.appendChild(r),lo(r,o)),r=i,a=f;}Ms(e,a,c,o),$s(e,t);},Ot=(e,t,o)=>{let r=se(t);if(r&&o.n.delete(r),e.isEqualNode(t))return;let n=e.getAttribute(s.qs.l);n!=="false"&&(n!=="children"&&$r(e,t),e.nodeName==="TEXTAREA"?co(e,t):ws(e,t,o));},Mr=(e,t,o)=>{if(e.nodeType!==1)return;let r=e.firstChild;for(;r;){let n;t&&(n=se(r))?o.a.add(n):(Ue(r),r.firstChild&&Mr(r,t,o)),r=r.nextSibling;}},lo=(e,t)=>{(e.nodeType===1||e.nodeType===11)&&cr(e);let o=e.firstChild;for(;o;){let r=o.nextSibling,n=se(o);if(n){let i=t.n.get(n);i&&Mt(o.nodeName,i.nodeName)?(o.parentNode.replaceChild(i,o),Ot(i,o,t)):lo(o,t);}else lo(o,t);o=r;}},Ms=(e,t,o,r)=>{for(;t;){let n=t.nextSibling;(o=se(t))?r.a.add(o):Pt(t,e,r),t=n;}},Pr=(e,t)=>{if(e.nodeType===1||e.nodeType===11){let o=e.firstChild;for(;o;){let r=se(o);r&&t.n.set(r,o),Pr(o,t),o=o.nextSibling;}}},be=(e,t)=>{let o=t.cloneNode(!0),r=p();r.a=j(),r.n=P(),o.nodeType===11&&(o=o.firstElementChild),Pr(e,r);let n=e,i=n.nodeType,a=o.nodeType;if(i===1)a===1?Mt(e.nodeName,o.nodeName)||(Ue(e),n=Cs(e,As(o.nodeName,o.namespaceURI))):n=o;else if(i===3||i===8){if(a===i)return n.nodeValue!==o.nodeValue&&(n.nodeValue=o.nodeValue),n;n=o;}if(n.isEqualNode(o))Ue(e);else {if(o.isEqualNode(n))return n;if(Ot(n,o,r),r.a.size>0){for(let c of r.a)if(r.n.has(c)){let l=r.n.get(c);Pt(l,l.parentNode,r,!1);}}}return n!==e&&e.parentNode&&(n.actualize&&(n=n.actualize(e.ownerDocument||document)),e.parentNode.replaceChild(n,e)),r.n.clear(),r.a.clear(),n};var Ye=(e,t)=>{if(!(e instanceof Element))return !1;let o=e.closest(t);return o&&o.tagName==="A"?o:!1},qt=e=>{if(e.nodeName!=="A")return 2;let t=e.getAttribute("href");if(!t||!io(t))return 2;let o=S(t);return o===null?2:q(o)?2:1},Or=(e,t)=>{let o=[];return G(e,r=>{if(r.nodeName!=="A")G(t,n=>qt(n)===1?o.push(n):null);else if(r.hasAttribute("href")&&io(r.href)){let n=S(r.href);S(n)!==null&&q(n)===!1&&o.push(r);}}),o},Ke=e=>{let t=[];return G(e,o=>qt(o)===1?t.push(o):null),t};var qr=e=>{let t=Ye(e.target,s.qs.p);if(!t)return;let o=L(t,10);if(q(o.key)||o.key in h.r)return;t.addEventListener(`${O}leave`,Sr,{once:!0});let r=w(o),n=r.threshold||s.config.hover.threshold;Ct(o.key,function(){C("prefetch",o,t)&&M(r).then(function(){delete h.r[o.key],Hr(t);});},n);},Sr=e=>{let t=Ye(e.target,s.qs.p);t&&$t(S(t.href));},Os=e=>e.addEventListener(`${O}enter`,qr),Hr=e=>{e.removeEventListener(`${O}enter`,qr),e.removeEventListener(`${O}leave`,Sr);},St=()=>{!s.config.hover||s.observe.hover||(H(Os,Ke(s.qs.p)),s.observe.hover=!0);},Ne=()=>{s.observe.hover&&(H(Hr,Ke(s.qs.p)),s.observe.hover=!1);};var de,qs=async e=>{if(e.isIntersecting){let t=L(e.target,11);if(!C("prefetch",t,e.target))return de.unobserve(e.target);await M(w(t))?de.unobserve(e.target):(u(`Prefetch will retry at next intersection for: ${t.key}`),de.observe(e.target));}},Ht=()=>{if(!s.config.intersect||s.observe.intersect)return;de||(de=new IntersectionObserver(H(qs),s.config.intersect));let e=H(o=>de.observe(o)),t=Or(s.qs.L,s.qs.w);e(t),s.observe.intersect=!0;},Ae=()=>{s.observe.intersect&&(de.disconnect(),s.observe.intersect=!1);};$e.qs=null;function $e(e){let t=s.resources.has(e);$e.qs===null&&($e.qs=$().querySelectorAll(`${s.page.target.join()},[${s.qs.f}]`));let o=$e.qs,r=o.length,n=-1;for(;++n<r;)if(o[n].contains(e))return t&&!1;return t&&!0}var Rr=(e,t)=>s.eval&&Do.test(t.nodeName)?(t.parentNode.nodeName==="HEAD"?dr(e,t):$e(t)?s.resources.delete(t):s.resources.add(t),!1):!0,Ss=(e,t)=>{let o=-1;for(;++o<t;){let r=e[o];r.nodeType===1&&Rr("appendChild",r)&&r instanceof HTMLElement&&r.hasAttribute(s.qs.s)&&Ge(r,Vo(r.parentElement));}},Hs=(e,t)=>{let o=-1;for(;++o<t;){let r=e[o];if(r.nodeType===1&&Rr("removeChild",r)&&r instanceof HTMLElement){let n=r.getAttribute(s.qs.e);r.getAttribute(s.qs.e)&&Ie(r,n.split(","));}}},Rt=new MutationObserver(([e])=>{if(e.type!=="childList")return;let t=e.addedNodes.length,o=e.removedNodes.length;t===0&&o===0||(t>0&&Ss(e.addedNodes,t),o>0&&Hs(e.removedNodes,o));}),Dt=()=>{s.observe.mutations||(Rt.observe(tt(),{childList:!0}),Rt.observe($(),{childList:!0,subtree:!0}),s.observe.mutations=!0);},kt=()=>{if(s.observe.mutations){Rt.takeRecords(),Rt.disconnect();for(let e of s.resources)$().removeChild(e),s.resources.delete(e);$e.qs=null,s.observe.mutations=!1;}};var Rs=({clientX:e,clientY:t},o)=>e<=o.right&&e>=o.left&&t<=o.bottom&&t>=o.top,Ds=e=>{let t=e.getBoundingClientRect(),o=e.getAttribute(s.qs.x),r=rt.test(o)?Number(o):s.config.proximity.distance;return {target:e,top:t.top-r,bottom:t.bottom+r,left:t.left-r,right:t.right+r}},ks=(e,t=!1)=>o=>{if(t)return;t=!0;let r=e.findIndex(n=>Rs(o,n));if(r===-1)B(()=>t=!1,s.config.proximity.throttle);else {let{target:n}=e[r];if(qt(n)===2)e.splice(r,1);else {let i=w(L(n,12)),a=i.threshold||s.config.proximity.threshold;Ct(i.key,async()=>{if(!C("prefetch",i,n))return ne();await M(i)&&(e.splice(r,1),t=!1,e.length===0&&(ne(),k("Proximity observer disconnected")));},a);}}},po,It=()=>{if(!s.config.proximity||s.observe.proximity)return;let t=Ke(s.qs.x).map(Ds);t.length>0&&(po=ks(t),addEventListener(`${O}move`,po,{passive:!0}),s.observe.proximity=!0);},ne=()=>{s.observe.proximity&&(removeEventListener(`${O}move`,po),s.observe.proximity=!1);};var Is=async(e,t,o)=>{if(!s.eval||!t.children||!o.children)return;let r=t.children,n=j(),i=o.children,a=[];for(let f=0,m=i.length;f<m;f++)Bt(i[f])&&n.add(i[f].outerHTML);for(let f=0,m=r.length;f<m;f++){let E=r[f],d=Bt(E),F=E.outerHTML;n.has(F)?d?a.push(E):n.delete(F):d&&a.push(E);}let c=[],l=document.createRange();for(let f of n){let m=l.createContextualFragment(f).firstChild;if(R(m,"href")||R(m,"src")){if(!C("resource",e,m))continue;let E,d=new Promise(F=>E=F);m.addEventListener("load",()=>E()),m.addEventListener("error",F=>{u(`Resource <${m.nodeName.toLowerCase()}> failed:`,F),E();}),c.push(d);}t.appendChild(m),n.delete(f);}for(let f=0,m=a.length;f<m;f++)t.removeChild(a[f]);await Promise.allSettled(c);},Us=(e,t)=>{let o=$();if(e.selector==="body"||e.fragments.length===0)be(o,t.body);else {let r=e.target.length>0?s.fragments.keys():e.fragments,n=s.registry.size>0,i="render"in s.events;for(let a of r){let c=s.fragments.get(a),l=t.body.querySelector(a);if(!(!l||!c)&&!(i&&!C("render",e,c,l)))if(y.marks.has(l.id))l.setAttribute(s.qs.e,c.getAttribute(s.qs.e));else {if(c.isEqualNode(l))continue;n&&Fe(l),be(c,l);}}}if(y.store&&gt(t,e.snap),e.type!==6&&oe("type",6),e.location.hash!==A){let r=o.querySelector(e.location.hash);r&&r.scrollIntoView();}scrollTo(e.scrollX,e.scrollY);},V=e=>{Ne(),Ae(),ne(),kt(),je(),Nt(),s.eval===!1&&(document.title=e.title);let t=Y(e.snap);return Is(e,tt(),t.head),Us(e,t),fe.done(),St(),Ht(),It(),pe(),Dt(),C("load",e),e};var v=window.history,kr=()=>v.state!==null&&"spx"in v.state&&"rev"in v.state.spx&&v.state.spx.key!==v.state.spx.rev,ho=e=>{if(console.log(v),v.state===null||typeof v.state!="object"||!("spx"in v.state))return !1;let t=at(v.state.spx)(["key","rev","scrollX","scrollY","title","target"]);return typeof e=="string"?t&&v.state.spx.key===e:t},Ws=async()=>{await nt(),s.loaded=!0;},Fs=e=>(ho(e.key)?(Object.assign(e,v.state.spx),scrollTo(v.state.spx.scrollX,v.state.spx.scrollY)):ie(e),e),ie=({key:e,rev:t,title:o,scrollX:r,scrollY:n,target:i})=>(v.replaceState({spx:p({key:e,rev:t,scrollX:r,scrollY:n,target:i,title:o||document.title})},o,e),x(`History replaceState: ${e}`),v.state.spx),ge=({key:e,rev:t,title:o,scrollX:r,scrollY:n,target:i})=>(v.pushState({spx:p({key:e,rev:t,scrollX:r,scrollY:n,target:i,title:o||document.title})},o,e),x(`History pushState: ${e}`),v.state.spx),Ir=async e=>{if(e.state===null||!("spx"in e.state))return;let{spx:t}=e.state;if(q(t.key)){if(!q(t.rev)&&t.rev!==t.key&&Lt(t),oe("type",5,t.key),!C("popstate",s.pages[t.key]))return;let{type:o,key:r}=V(s.pages[t.key]);x(`History popState ${o===4?"session":"reverse"}: ${r}`);}else {if(x(`History popState fetch: ${t.key}`),t.type=5,!C("popstate",t))return;let o=await M(t);if(!o)return location.assign(t.key);let r=S(location);if(o.key===r)x(`History popState fetch Complete: ${t.key}`),o.target=[],o.selector=null,V(o);else if(q(r))V(s.pages[r]);else {let n=w(L(r,5));if(!C("popstate",n))return;let i=await M(n);i&&ge(i);}}},Ur=e=>{if(!s.observe.history)return addEventListener("popstate",Ir,!1),s.observe.history=!0,typeof e=="object"&&e.type===0?Fs(e):e},Wr=()=>{s.observe.history&&(v.scrollRestoration&&(v.scrollRestoration="auto"),removeEventListener("popstate",Ir,!1),removeEventListener("load",Ws,!1),s.observe.history=!1);};var js=e=>{for(let t of ["hover","intersect","proximity","progress"])R(e,t)&&(e[t]===!1?s.config[t]=!1:typeof e[t]=="object"&&Object.assign(s.config[t],e[t]),delete e[t]);return e},Je=(e,t)=>{let o=`:not([${e}${t}=false]):not([${e}link]):not`;switch(t.charCodeAt(0)){case 104:return `${o}([${e}proximity]):not([${e}intersect])`;case 105:return `${o}([${e}hover]):not([${e}proximity])`;case 112:return `${o}([${e}intersect]):not([${e}hover])`}},Vs=(e,t,o)=>{if("eval"in e)if(e.eval){if(typeof e.eval=="object"){let r=Object.assign(s.config.eval,e.eval);s.eval=!(r.link===!1&&r.meta===!1&&r.script===!1&&r.style===!1);}}else s.eval=!1;return r=>{if(s.eval===!1||s.config.eval[r]===!1)return `${r}[${t}eval]:${o}`;if(s.config.eval[r]===!0)return `${r}:${o}`;let n=r==="link"?`${r}[rel=stylesheet]:${o}`:`${r}:${o}${r==="script"?`:not([${t}eval=hydrate])`:""}`;if(s.config.eval[r]===null)return n;if(Array.isArray(s.config.eval[r]))return s.config.eval[r].length>0?s.config.eval[r].map(i=>`${i}:${o}`).join(","):(u(`Missing eval ${r} value, default will be used`),n);T(`Invalid "eval" ${r} value, expected boolean or array type`);}},Bs=e=>{let t=[];if("fragments"in e&&Array.isArray(e.fragments)&&e.fragments.length>0)for(let o of e.fragments){let r=o.charCodeAt(0);if(r===46||r===91){u(`Invalid fragment, only element id values allowed: "${o}"`);continue}else r===35?t.push(o.trim()):t.push(`#${o.trim()}`);}else return ["body"];return t},Fr=(e=p())=>{"logLevel"in e&&(s.logLevel=e.logLevel,s.logLevel===3&&x("DEBUG MODE")),Ko(),Object.defineProperties(s,{history:{get:()=>typeof v.state=="object"&&"spx"in v.state?v.state.spx:null},ready:{get:()=>document.readyState==="complete"},types:{get:()=>p({INITIAL:0,PREFETCH:1,FETCH:2,PRELOAD:3,REVERSE:4,POPSTATE:5,VISIT:6,HYDRATE:7,CAPTURE:8,RELOAD:9,HOVER:10,INTERSECT:11,PROXIMITY:12})}}),"components"in e&&(Q(e.components),delete e.components),Object.assign(s.config,js(e));let t=s.config.schema,o=t==="spx"?"spx":t.endsWith("-")?t:t===null?A:`${t}-`,r=`:not([${o}disable]):not([href^=\\#])`,n=`not([${o}eval=false])`,i=Vs(e,o,n);s.config.fragments=Bs(e),s.config.schema=o,s.config.index=null,s.memory.bytes=0,s.memory.visits=0,s.memory.limit=s.config.maxCache,s.qs.C=new RegExp(`^href|${o}(hydrate|append|prepend|target|progress|threshold|scroll|position|proximity|hover|cache|history)$`,"i"),s.qs.q=new RegExp(`${o}(?:node|bind|component)|@[a-z]|[a-z]:[a-z]`,"i"),s.qs.N=new RegExp(`^${o}[a-zA-Z0-9-]+:`,"i"),s.qs.f=`${o}target`,s.qs.h=`${o}fragment`,s.qs.y=`[${s.qs.h}]`,s.qs.E=`[${o}target]:not(a[spx-target]):not([${o}target=false])`,s.qs.l=`${o}morph`,s.qs.b=`${o}eval`,s.qs.L=`[${o}intersect]${Je(o,"intersect")}`,s.qs.S=`[${o}track]:not([${o}track=false])`,s.qs.s=`${o}component`,s.qs.m=`${o}node`,s.qs.d=`${o}bind`,s.qs.e="data-spx",s.qs.M=`a${s.config.annotate?`[${o}link]`:""}${r}`,s.qs.g=i("script"),s.qs.H=i("style"),s.qs.T=i("link"),s.qs.v=i("meta"),s.qs.R=`script[${o}eval=hydrate]:${n}`,s.qs.D=`link[rel=stylesheet][href*=\\.css]:${n},script[src*=\\.js]:${n}`,s.qs.u=`${o}data:`,s.qs.x=`a[${o}proximity]${r}${Je(o,"proximity")}`,s.qs.w=`a${r}${Je(o,"intersect")}`,s.qs.p=s.config.hover!==!1&&s.config.hover.trigger==="href"?`a${r}${Je(o,"hover")}`:`a[${o}hover]${r}${Je(o,"hover")}`,fe.style(s.config.progress);};var Gs=e=>!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.button>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey),W=function(e){if(!Gs(e))return;let t=Ye(e.target,s.qs.M);if(!t)return;let o=S(t.href);if(o===null)return;let r=o===s.page.key,n=()=>{u(`Drag occurance, visit cancelled: ${o}`),W.drag=!0,t.removeEventListener(`${O}move`,n);};if(t.addEventListener(`${O}move`,n,{once:!0}),W.drag===!0)return W.drag=!1,W(e);t.removeEventListener(`${O}move`,n);let i=(a,c,l=!0)=>{a.preventDefault(),s.pages[c.key].ts=it(),s.pages[c.key].visits=c.visits+1,s.pages[c.key].target=s.pages[c.rev].target=c.target,s.pages[c.key].selector=s.pages[c.rev].selector=c.selector,s.pages[c.rev].scrollX=window.scrollX,s.pages[c.rev].scrollY=window.scrollY,!("visit"in s.events&&!C("visit",s.pages[c.key],a))&&(r?k(`Identical pathname, page visit skipped: ${o}`):(ie(s.pages[c.rev]),l?(ge(c),V(c)):jr(c)));};if(Ne(),ne(),Ae(),q(o)){let a=no(t,s.pages[o]),c=re(a);t.onclick=l=>i(l,c);}else if(h.c.has(o)){ao(o),k(`Request in transit: ${o}`);let a=s.pages[o];t.onclick=c=>i(c,a,!1);}else {ao(),$t(o);let a=w(L(t,6));M(a),t.onclick=c=>i(c,a,!1);}};async function jr(e){e.progress&&fe.start(e.progress);try{let t=await _e(e);t?(t.history==="replace"?ie(t):ge(t),V(t)):location.assign(e.key);}catch(t){location.assign(e.key);}}var Eo=async(e,t)=>{if(t){typeof t.cache=="string"&&(t.cache==="clear"?K():K(t.key)),t.progress&&fe.start(t.progress);let o=await M(t);o?(ge(o),V(o)):location.assign(t.key);}else return jr(s.pages[e])},Vr=()=>{s.observe.hrefs||(W.drag=!1,Le==="mouseOnly"?addEventListener(`${O}down`,W,!1):(Le==="touchOnly"||addEventListener(`${O}down`,W,!1),addEventListener("touchstart",W,!1)),s.observe.hrefs=!0);},Br=()=>{s.observe.hrefs&&(Le==="mouseOnly"?removeEventListener(`${O}down`,W,!1):(Le==="touchOnly"||removeEventListener(`${O}down`,W,!1),removeEventListener("touchstart",W,!1)),s.observe.hrefs=!1);};var Xr=()=>{let e=L(0),t=Ur(w(e));Object.defineProperty(y,"refs",{configurable:!1,enumerable:!1,get(){return this.snaps.length>0?this.snaps[this.snaps.length-1][1]:P()}}),Object.defineProperties(s,{prev:{get:()=>s.pages[s.history.rev]},page:{get:()=>s.pages[s.history.key]},snapDom:{get:()=>ce(s.snaps[s.page.snap])}});let o=()=>{let r=xe(t,le());return Vr(),Nt(),St(),Ht(),It(),pe(),Dt(),C("connect",r),lt(()=>oe("type",6),async()=>await Lt(r),async()=>await Ar(r)),r};return new Promise(r=>{document.readyState==="loading"?addEventListener("DOMContentLoaded",()=>r(o())):r(o());})},zr=()=>{Wr(),Br(),kt(),Ne(),Ae(),ne(),s.config.components&&(je(),to(),s.registry.clear()),K(),s.config.globalThis&&delete window.spx,k("Disconnected");};function N(e={}){if(!Ft)return T("Invalid runtime environment: window is undefined.");if(!N.supported)return T("Browser does not support SPX");if(!window.location.protocol.startsWith("http"))return T("Invalid protocol, SPX expects HTTPS or HTTP protocol");Fr(e),s.config.globalThis&&window&&!("spx"in window)&&J(window,"spx",N);let t=Xr();return async function(o){let r=await t;if(o.constructor.name==="AsyncFunction")try{await o(r);}catch(n){T("Connection Error",n);}else o(r);k("Connection Established");}}N.Component=me;N.on=Jo;N.off=Zo;N.component=xo;N.live=zs;N.capture=en;N.form=on;N.render=Qs;N.session=Ys;N.reload=Ks;N.fetch=Js;N.clear=K;N.hydrate=rn;N.prefetch=tn;N.route=sn;N.disconnect=zr;N.register=_s;N.dom=Zs;N.supported=Xs();Object.defineProperties(N,{$:{get:()=>s},history:{value:{get state(){return s.history},api:v,push:ge,replace:ie,has:ho,reverse:kr}}});function Xs(){return !!(Ft&&window.history.pushState&&window.requestAnimationFrame&&window.DOMParser&&window.Proxy)}function zs(e=null,...t){let o=e?[e,...t].flat():null,r={};for(let{scope:{alias:n,instanceOf:i}}of s.instances.values()){let a=o?o.includes(n)?n:o.includes(i)?i:null:null;r[a||!o&&(n||i)]=Array.isArray(r[a||!o&&i])?[...r[a||!o&&i],xo]:xo;}return r}function xo(e,t){let o=[];for(let r of o.values()){let{scope:n}=r;(n.instanceOf===e||n.alias===e)&&o.push(r);}return t?H(t,o):o[0]}function _s(...e){if(typeof e[0]=="string")e.length>2&&T(`Named component registration expects 2 parameters, recieved ${e.length}.`,e),Q({[Ve[0]]:e[1]});else for(let t of e)if(Array.isArray(t))for(let o of t)typeof o[0]=="string"?Q({[o[0]]:o[1]}):typeof o=="function"&&Q({[ft(o)]:o},!0);else typeof t=="function"?Q({[ft(t)]:t},!0):typeof t=="object"&&Q(t);pe();}function Ys(){return ["config","snaps","pages","observers","fragments","instances","mounted","registry","reference","memory"].reduceRight((e,t)=>Object.defineProperty(e,t,{get:t==="memory"?()=>s[t].size=Go(s[t].bytes):()=>s[t],enumerable:!1,configurable:!1}),p())}async function Ks(){s.page.type=9;let e=await M(s.page);return e?(k("Triggered reload, page was re-cached"),V(e)):(u("Reload failed, triggering refresh (cache will purge)"),location.assign(s.page.key))}async function Js(e){let t=L(e,2);if(t.location.origin!==ae){T("Cross origin fetches are not allowed");return}let o=await ze(t.key);if(o)return o}function Zs(e,...t){let o=e[0];for(let c=0,l=t.length;c<l;c++)o+=t[c]+e[c+1];let r=o,n=document.createElement("div");n.innerHTML=r;let i=n.children.length;if(i===0)return null;if(i===1)return J(n.children[0],"raw",r);let a=J([],"raw",r);for(;n.firstChild;){let c=n.firstElementChild;c&&a.push(c),n.removeChild(n.firstChild);}}async function Qs(e,t,o){let r=s.page,n=L(e);n.location.origin!==ae&&T("Cross origin fetches are not allowed");let i=await ze(n.key,{type:"document"});if(i||T(`Fetch failed for: ${n.key}`,i),await o.call(r,i),t==="replace"){r.title=i.title;let a=re(Object.assign(r,n),le(i));return ie(a),a}else return V(xe(n,le(i)))}function en(e){let t=br();if(!t)return;let o=Y();if(e=Array.isArray(e)?e:t.target,e.length===1&&e[0]==="body"){be(o.body,$()),re(t,le(o));return}let r=e.join(","),n=$().querySelectorAll(r);G(o.body.querySelectorAll(r),(i,a)=>{be(i,n[a]);}),re(t,le(o));}async function tn(e){let t=L(e,1);if(q(t.key)){u(`Cache already exists for ${t.key}, prefetch skipped`);return}let o=await M(w(t));if(o)return o;T(`Prefetch failed for ${t.key}`);}async function on(e,t){let o=new FormData;for(let n in t.data)o.append(n,t.data[n]);return await ze(e,{method:t.method,body:o})}async function rn(e,t){let o=L(e,7);if(M(o),Array.isArray(t)){o.hydrate=[],o.preserve=[];for(let n of t)n.charCodeAt(0)===33?o.preserve.push(n.slice(1)):o.hydrate.push(n);}else o.hydrate=s.config.fragments;let r=await _e(o);if(r){let{key:n}=s.history;if(ie(r),V(r),o.key!==n){s.index===n&&(s.index=o.key);for(let i in s.pages)s.pages[i].rev===n&&(s.pages[i].rev=o.key);K(n);}}return Y(r.key)}async function sn(e,t){let o=L(e),r=typeof t=="object"?Object.assign(o,t):o;return q(o.key)?Eo(o.key,re(r)):Eo(o.key,w(r))}

export { N as default };
