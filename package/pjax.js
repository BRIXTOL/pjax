var u=(e,t,r)=>new Promise((o,n)=>{var s=x=>{try{N(r.next(x))}catch(z){n(z)}},f=x=>{try{N(r.throw(x))}catch(z){n(z)}},N=x=>x.done?o(x.value):Promise.resolve(x.value).then(s,f);N((r=r.apply(e,t)).next())});function Y(){return Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Y.apply(this,arguments)}var U;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(U||(U={}));var tt=function(e){return e};var rt="beforeunload";var or="popstate";function it(e){e===void 0&&(e={});var t=e,r=t.window,o=r===void 0?document.defaultView:r,n=o.history;function s(){var c=o.location,m=c.pathname,E=c.search,H=c.hash,R=n.state||{};return[R.idx,tt({pathname:m,search:E,hash:H,state:R.usr||null,key:R.key||"default"})]}var f=null;function N(){if(f)D.call(f),f=null;else{var c=U.Pop,m=s(),E=m[0],H=m[1];if(D.length){if(E!=null){var R=C-E;R&&(f={action:c,location:H,retry:function(){re(R*-1)}},re(R))}}else Ae(c)}}o.addEventListener(or,N);var x=U.Pop,z=s(),C=z[0],le=z[1],Ye=nt(),D=nt();C==null&&(C=0,n.replaceState(Y({},n.state,{idx:C}),""));function Ue(c){return typeof c=="string"?c:ir(c)}function Je(c,m){return m===void 0&&(m=null),tt(Y({pathname:le.pathname,hash:"",search:""},typeof c=="string"?ue(c):c,{state:m,key:nr()}))}function Ge(c,m){return[{usr:c.state,key:c.key,idx:m},Ue(c)]}function Qe(c,m,E){return!D.length||(D.call({action:c,location:m,retry:E}),!1)}function Ae(c){x=c;var m=s();C=m[0],le=m[1],Ye.call({action:x,location:le})}function Ze(c,m){var E=U.Push,H=Je(c,m);function R(){Ze(c,m)}if(Qe(E,H,R)){var K=Ge(H,C+1),Oe=K[0],fe=K[1];try{n.pushState(Oe,"",fe)}catch{o.location.assign(fe)}Ae(E)}}function et(c,m){var E=U.Replace,H=Je(c,m);function R(){et(c,m)}if(Qe(E,H,R)){var K=Ge(H,C),Oe=K[0],fe=K[1];n.replaceState(Oe,"",fe),Ae(E)}}function re(c){n.go(c)}var rr={get action(){return x},get location(){return le},createHref:Ue,push:Ze,replace:et,go:re,back:function(){re(-1)},forward:function(){re(1)},listen:function(m){return Ye.push(m)},block:function(m){var E=D.push(m);return D.length===1&&o.addEventListener(rt,ot),function(){E(),D.length||o.removeEventListener(rt,ot)}}};return rr}function ot(e){e.preventDefault(),e.returnValue=""}function nt(){var e=[];return{get length(){return e.length},push:function(r){return e.push(r),function(){e=e.filter(function(o){return o!==r})}},call:function(r){e.forEach(function(o){return o&&o(r)})}}}function nr(){return Math.random().toString(36).substr(2,8)}function ir(e){var t=e.pathname,r=t===void 0?"/":t,o=e.search,n=o===void 0?"":o,s=e.hash,f=s===void 0?"":s;return n&&n!=="?"&&(r+=n.charAt(0)==="?"?n:"?"+n),f&&f!=="#"&&(r+=f.charAt(0)==="#"?f:"#"+f),r}function ue(e){var t={};if(e){var r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));var o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}var P=it(),I=Object.assign;var a=Object.create,pe=Array.isArray,j=Array.from,Ne="";var i=st(null),l=a(null),p=a(null),d=a(null),b=a(null),He=new Set;function st(e){let t=a(e);return t.targets=["body"],t.timeout=3e4,t.poll=15,t.schema="pjax",t.async=!0,t.cache=!0,t.reverse=!0,t.limit=50,t.preload=null,t.hover=a(null),t.hover.trigger="attribute",t.hover.threshold=250,t.intersect=a(null),t.intersect.rootMargin="0px 0px 0px 0px",t.intersect.threshold=0,t.proximity=a(null),t.proximity.distance=75,t.proximity.threshold=250,t.proximity.throttle=500,t.progress=a(null),t.progress.background="#111",t.progress.height="3px",t.progress.minimum=.08,t.progress.easing="linear",t.progress.speed=300,t.progress.trickle=!0,t.progress.threshold=350,t.progress.trickleSpeed=300,t}function Me(e={}){e.hover!==void 0&&(typeof e.hover!="boolean"?I(i.hover,e.hover):e.hover===!1&&(i.hover=e.hover),delete e.hover),e.intersect!==void 0&&(typeof e.intersect!="boolean"?I(i.intersect,e.intersect):e.intersect===!1&&(i.intersect=e.intersect),delete e.intersect),e.proximity!==void 0&&(typeof e.proximity!="boolean"?I(i.proximity,e.proximity):e.proximity===!1&&(i.proximity=e.proximity),delete e.proximity),e.progress!==void 0&&(typeof e.progress!="boolean"?I(i.progress,e.progress):e.progress===!1&&(i.progress=e.progress),delete e.progress);let t=i.schema===null?"data":`data-${i.schema}`,r=`:not([${t}-disable]):not([href^="#"])`;return p.attrs=new RegExp("^href|"+t+"-("+"hydrate|append|prepend|replace|progress|threshold|position|proximity|hover|history"+")$","i"),p.hydrate=`[${t}-hydrate]`,p.track=`[${t}-track]:not([${t}-track=false])`,p.script=`script:not([${t}-eval=false])`,p.style=`style:not([${t}-eval=false])`,p.styleLink=`link[rel=stylesheet]:not([${t}-eval=false])`,p.href=`a${r}`,i.intersect!==!1&&(p.intersect=`[${t}-intersect]:not([${t}-intersect=false])`,p.interHref=`a${r}:not([${t}-intersect=false])`),i.proximity!==!1&&(p.proximity=`a[${t}-proximity]${r}:not([${t}-proximity=false])`),i.hover!==!1&&(p.hover=i.hover.trigger==="href"?`a${r}:not([${t}-hover=false]):not([${t}-intersect]):not([${t}-proximity])`:`a[${t}-hover]${r}:not([${t}-hover=false]):not([${t}-intersect]):not([${t}-proximity])`),I(i,e)}var at=/https?:\/\/(w{3}\.)?/,ct=/(?:https?:)?\/\/(?:w{3}\.)?([^/]*?)?([/?][^;]*?)?(#[^#]*?)?$/i;var lt=/\b(?:append|prepend)/,ft=/^(?:application|text)\/(?:x-)?(?:ecma|java)script|text\/javascript$/,ut=/^\b(?:true|false)$/i,J=/^[+-]?\d*\.?\d+$/,pt=/\s+/g;var $e=/\[?[^,'"[\]()\s]+\]?/g,mt=/\(?\[(['"]?.*['"]?,?)\]\)?/,dt=/[xy]:[0-9.]+/,ht=/[xy]|\d*\.?\d+/g;function vt(){return Math.random().toString(36).slice(2)}function yt(e=2){return(t,r)=>{let o=t.length;return(o<1||t[o-1].length===e?t.push([r]):t[o-1].push(r))&&t}}var xt=e=>{let t=a(null);return L((r,o,n)=>{let s=n.length-1>=o?o-1:o;o%2&&(t[n[s]]=J.test(r)?Number(r):r)},e),t};function oe(e,t){if(e instanceof Element){let r=e.closest(t);if(r&&r.tagName==="A")return r}return!1}function bt(e){return new Blob([e]).size}function Se(e){if(e.nodeName!=="A")return!1;let t=e.getAttribute("href");return(t in d&&"snapshot"in d[t]?d[t].uuid in b:!1)===!1}function Et(e,t){let r=document.body.querySelectorAll(e);return j(r).flatMap(n=>n.nodeName!=="A"?j(n.querySelectorAll(t)).filter(Se):Se(n)?n:[])}var ne=e=>{let t=document.body.querySelectorAll(e);return j(t).filter(Se)};function L(e,t){if(arguments.length===1)return n=>L(e,n);let r=t.length;if(r===0)return;let o=0;for(;o<r;)e(t[o],o,t),o++}function je(e){let t=Object.getOwnPropertyNames(e);return t.length===0?!0:t.every(r=>delete e[r])}var{origin:me}=window.location,Pt=me.replace(at,Ne),ie;function sr(e){let t=a(null);for(let{nodeName:r,nodeValue:o}of e.attributes){if(!p.attrs.test(r))continue;if(r==="href"){let f=ue(o);t.key=f.pathname+(f.search||""),t.rev=location.pathname+(location.search||""),t.location=It(t.key);continue}let n=r.slice(1+r.lastIndexOf("-")),s=o.replace(pt,Ne);mt.test(s)?t[n]=lt.test(n)?s.match($e).reduce(yt(2),[]):s.match($e):dt.test(s)?t[n]=xt(s.match(ht)):ut.test(s)?t[n]=s==="true":J.test(s)?t[n]=Number(s):t[n]=s}return t}function se(e){if(e.charCodeAt(0)===47&&e.charCodeAt(1)!==47){let r=e.indexOf("#");return r!==-1?e.slice(0,r):e}if(e.charCodeAt(0)===63)return location.pathname+e;let t=e.match(ct);return t!==null?Pt!==t[1]?null:t[2]===void 0?"/":t[2]:null}function It(e){let t=a(null),{hash:r,pathname:o,search:n}=ue(e);return t.origin=me,t.hostname=Pt,t.pathname=o,n&&(t.search=n),r&&(t.hash=r),t}function h(e,t){if(e instanceof Element){let o=sr(e);return o.type=t||2,o}let r=a(null);return r.key=typeof e=="string"?se(e):location.pathname+(location.search||""),r.rev=location.pathname+(location.search||""),r.location=It(r.key),r.type=t||2,ie=r.key,r}var ar=new DOMParser;function q(e){return ar.parseFromString(e,"text/html")}var V=a(null);function v(e,...t){let r=e==="store";r&&t.splice(-1,1,q(t[t.length-1]));let o=!0;return L(n=>{let s=n.apply(null,t);r?s instanceof Document?o=s.documentElement.outerHTML:typeof o!="string"&&(o=s!==!1):o=s!==!1},V[e]||[]),o}function cr(e,t){e in V||(V[e]=[]),V[e].push(t)}function lr(e,t){let r=V[e],o=[];if(r&&t){let n=0,s=r.length;for(;n<s;n++)r[n]!==t&&o.push(r[n])}return o.length?V[e]=o:delete V[e],this}var G=a(null),qe=!1;function _(){return G}function Ce(){G.y=scrollY,G.x=scrollX,qe||(requestAnimationFrame(_),qe=!0)}function fr(){return qe=!1,G.x=0,G.y=0,G}function wt(){let e=a(null);return e.x=0,e.y=0,e}function Lt(){l.scroll||(Ce(),addEventListener("scroll",Ce,{passive:!0}),l.scroll=!0)}function kt(){!l.scroll||(removeEventListener("scroll",Ce,!1),fr(),l.scroll=!1)}function B(e){typeof e=="undefined"?(je(d),je(b)):typeof e=="string"?(delete b[d[e].uuid],delete d[e]):pe(e)&&Ve(e)}function y(e){let t=a(null);return t.attrs=a(null),t.location=a(null),t.key=null,t.type=2,t.title=document.title,t.attrs.cache=i.cache,t.uuid=t.attrs.cache?vt():null,t.position=wt(),e.type===6&&(t.attrs.proximity=i.proximity.distance,t.attrs.threshold=i.proximity.threshold),e.type===4&&(t.attrs.threshold=i.hover.threshold),i.hover!==!1&&(t.attrs.threshold=i.hover.threshold),i.progress!==!1&&(t.attrs.progress=i.progress.threshold),I(t,e)}function he(e,t){let r=v("store",e,t);if(r!==!1){switch(e.type){case 4:case 6:case 5:e.type=11;break}return d[e.key]=e,e.attrs.cache&&(b[e.uuid]=typeof r=="string"?r:t),e}}function $(e,t){let r=e.key in d?I(d[e.key],e):y(e);return typeof t=="string"&&(b[r.uuid]=t),r}function De(e){let t=a(null);return e=e||ie,t.page=d[e],t.dom=q(b[t.page.uuid]),t}function w(e){return e in d&&"uuid"in d[e]?d[e].uuid in b:!1}function Ve(e=[]){return Object.getOwnPropertyNames(d).forEach(t=>{e.includes(t)?delete b[d[t].uuid]:delete d[t]})}var k=typeof window<"u"?window:{screen:{},navigator:{}},Q=(k.matchMedia||function(){return{matches:!1}}).bind(k),ur=!1,pr={get passive(){return ur=!0}},Tt=function(){};k.addEventListener&&k.addEventListener("p",Tt,pr);k.removeEventListener&&k.removeEventListener("p",Tt,!1);var A="PointerEvent"in k,_e="ontouchstart"in k,mr="TouchEvent"in k,dr=_e||mr&&Q("(any-pointer: coarse)").matches,Lo=(k.navigator.maxTouchPoints||0)>0||dr,Rt=k.navigator.userAgent||"",hr=Q("(pointer: coarse)").matches&&/iPad|Macintosh/.test(Rt)&&Math.min(k.screen.width||0,k.screen.height||0)>=768,ko=(Q("(pointer: coarse)").matches||!Q("(pointer: fine)").matches&&_e)&&!/Windows.*Firefox/.test(Rt),To=Q("(any-pointer: fine)").matches||Q("(any-hover: hover)").matches||hr||!_e;var F=null,ae=null,Be=[];function Fe(e){let{speed:t,easing:r,minimum:o}=i.progress,n=typeof F=="number";e=Ot(e,o,1),F=e===1?null:e;let s=gr(!n);s.offsetWidth,yr(f=>{if(s.style.transform=`translate3d(${Nt(e)}%,0,0)`,s.style.transition=`all ${t}ms ${r}`,e!==1)return setTimeout(f,t);s.style.transition="none",s.style.opacity="1",s.offsetWidth,setTimeout(()=>{s.style.transition=`all ${t}ms ${r}`,s.style.opacity="0",setTimeout(()=>[vr(),f()],t)},t)})}function At(e){let t=F;if(!t)return We();if(t<1)return typeof e!="number"&&(t>=0&&t<.2?e=.1:t>=.2&&t<.5?e=.04:t>=.5&&t<.8?e=.02:t>=.8&&t<.99?e=.005:e=0),t=Ot(t+e,0,.994),Fe(t)}function gr(e){if(ae)return ae;document.documentElement.classList.add("pload");let t=e?"-100":Nt(F||0),r=document.createElement("div");return r.id="pprogress",r.style.pointerEvents="none",r.style.background=i.progress.background,r.style.height=i.progress.height,r.style.position="fixed",r.style.zIndex="9999",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.transition="all 0 linear",r.style.transform=`translate3d(${t}%,0,0)`,document.body.appendChild(r),ae=r,r}function vr(){document.documentElement.classList.remove("pload"),document.getElementById("pprogress")&&document.body.removeChild(ae),ae=null}function Ot(e,t,r){return e<t?t:e>r?r:e}function Nt(e){return(-1+e)*100}function yr(e){let t=()=>{let r=Be.shift();r&&r(t)};Be.push(e),Be.length===1&&t()}function We(){if(!i.progress)return;F||Fe(0);let e=function(){setTimeout(()=>{!F||(At(),e())},i.progress.trickleSpeed)};i.progress.trickle&&e()}function Ht(e){if(!(!e&&!F))return At(.3+.5*Math.random()),Fe(1)}var T=a(null);function xr(e){return new Promise(t=>setTimeout(()=>t(e()),5))}var $t=0;function br(e){return u(this,null,function*(){$t=$t+bt(e)})}var W=a(null);function ge(e){let t=new XMLHttpRequest;return new Promise((r,o)=>{t.open("GET",e,i.async),t.setRequestHeader("X-Brixtol-Pjax","true"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.onloadstart=n=>{T[e]=t},t.onload=n=>{r(t.status===200?t.responseText:!1)},t.onabort=n=>{delete T[e]},t.onloadend=n=>{delete T[e],br(t.responseText)},t.onerror=o,t.timeout=i.timeout,t.responseType="text",t.send(null)})}function ve(e,t,r){e in W||w(e)||(W[e]=setTimeout(t,r))}function St(e){return e in W?(clearTimeout(W[e]),delete W[e]):!0}function ye(e){e in T&&(T[e].abort(),console.warn(`@brixtol/pjax: XHR Request was cancelled for url: ${e}`))}function jt(e){if(e in T)for(let t in T)e!==t&&(T[t].abort(),console.warn(`@brixtol/pjax: Cancelled pending request: ${t}`))}function Xe(e,t=0){return u(this,null,function*(){return e in T&&t<=i.timeout?(i.progress!==!1&&t*5===i.progress.threshold&&We(),t++,xr(()=>Xe(e,t))):delete T[e]})}function g(e){return u(this,null,function*(){if(e.key in T){console.warn(`@brixtol/pjax: XHR Request is already in transit for: ${e.key}`);return}if(!v("fetch",e))return console.info(`@brixtol/pjax: Request cancelled via dispatched event for: ${e.key}`),!1;try{let t=yield ge(e.key);if(t)return he(e,t);console.warn(`@brixtol/pjax: Failed to retrive response at: ${e.key}`)}catch(t){delete T[e.key],console.error("@brixtol/pjax: Fetch error:",t)}return!1})}function be(e){let t=oe(e.target,p.hover);t&&(St(se(t.href)),qt(t))}function Z(e){let t=oe(e.target,p.hover);if(!t)return;let r=h(t,4);if(r.key in W)return;if(w(r.key))return xe(t);Er(t);let o=y(r),n=o.attrs.threshold||i.hover.threshold;ve(r.key,()=>u(this,null,function*(){if(!v("prefetch",t,r))return xe(t);(yield g(o))&&xe(t)}),n)}function qt(e){A?e.addEventListener("pointerenter",Z,!1):e.addEventListener("mouseenter",Z,!1)}function Er(e){A?(e.addEventListener("pointerout",be,!1),e.removeEventListener("pointerenter",Z,!1)):(e.addEventListener("mouseleave",be,!1),e.removeEventListener("mouseenter",Z,!1))}function xe(e){A?(e.removeEventListener("pointerenter",Z,!1),e.removeEventListener("pointerout",be,!1)):(e.removeEventListener("mouseleave",be,!1),e.removeEventListener("mouseenter",Z,!1))}function Ee(){!i.hover||l.hover||(L(qt,ne(p.hover)),l.hover=!0)}function Pe(){!l.hover||(L(xe,ne(p.hover)),l.hover=!1)}var ee;function Pr(e){return u(this,null,function*(){if(e.isIntersecting){let t=h(e.target,5);if(!v("prefetch",e.target,t))return ee.unobserve(e.target);(yield g(y(t)))?ee.unobserve(e.target):(console.warn(`@brixtol/pjax: Prefetch will retry at next intersect for: ${t.key}`),ee.observe(e.target))}})}function Ie(){!i.intersect||l.intersect||(ee=new IntersectionObserver(L(Pr),i.intersect),L(ee.observe,Et(p.intersect,p.interHref)),l.intersect=!0)}function we(){!l.intersect||(ee.disconnect(),l.intersect=!1)}function Ir(e){return new Promise((t,r)=>{let o=document.createElement("script");o.addEventListener("error",r),o.async=!1,o.text=e.target.text;for(let{nodeName:n,nodeValue:s}of e.target.attributes)o.setAttribute(n,s);document.contains(e.target)?e.target.replaceWith(o):(document.head.append(o),e.external?o.addEventListener("load",()=>o.remove()):o.remove()),e.external?o.addEventListener("load",()=>t()):t()})}function wr(e){if(!e.hasAttribute("src")&&!e.text)return;let t=e.type?e.type.trim().toLowerCase():"text/javascript",r=ft.test(t)?1:t==="module"?2:NaN,o=a(null);return o.blocking=!0,o.evaluate=!1,o.external=!1,isNaN(r)||e.noModule&&r===1||(e.src&&(o.external=!0),(r!==1||o.external&&(e.hasAttribute("async")||e.defer))&&(o.blocking=!1),o.evaluate=!0,o.target=e),o}function Vt(e){return u(this,null,function*(){try{let t=Ir(e);e.blocking&&(yield t)}catch(t){console.error(t)}})}function _t(e){return u(this,null,function*(){let r=j(e,wr).filter(o=>o.evaluate).reduce((o,n)=>u(this,null,function*(){return n.external?Promise.all([o,Vt(n)]):(yield o,yield Vt(n))}),Promise.resolve());yield Promise.race([r])})}function Lr({clientX:e,clientY:t},r){return e<=r.right&&e>=r.left&&t<=r.bottom&&t>=r.top}function kr(e){let t=a(null),r=e.getBoundingClientRect(),o=e.getAttribute(`${i.schema}-proximity`),n=J.test(o)?Number(o):i.proximity.distance;return t.target=e,t.top=r.top-n,t.bottom=r.bottom+n,t.left=r.left-n,t.right=r.right+n,t}function Tr(e){let t=!1;return r=>{if(t)return;t=!0;let o=e.findIndex(n=>Lr(r,n));if(o===-1)setTimeout(()=>{t=!1},i.proximity.throttle);else{let{target:n}=e[o],s=y(h(n,6));ve(s.key,()=>u(this,null,function*(){if(!v("prefetch",n,s))return stop();(yield g(s))&&(e.splice(o,1),t=!1,e.length===0&&(stop(),console.info("@brixtol/pjax: Proximity observer has disconnected")))}),s.attrs.threshold||i.proximity.threshold)}}}var ce;function Le(){if(!i.proximity||l.proximity)return;let e=ne(p.proximity).map(kr);e.length>0&&(ce=Tr(e),A?addEventListener("pointermove",ce,!1):addEventListener("mousemove",ce,!1),l.proximity=!0)}function ke(){!l.proximity||(A?removeEventListener("pointermove",ce,!1):removeEventListener("mousemove",ce,!1),l.proximity=!1)}function Rr(e,t){return e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING||-1}function Ar(e){return u(this,null,function*(){let t=j(e.querySelectorAll(p.script));t.sort(Rr),yield _t(t)})}function Or(e){e.querySelectorAll(p.track).forEach(r=>{!r.hasAttribute("id")||He.has(r.id)||(document.body.appendChild(r),He.add(r.id))})}function Nr(e,t){let r;if(e.attrs.replace){let f=i.targets.indexOf("body");i.targets.splice(f,1),r=e.attrs.replace.concat(i.targets)}else if(r=i.targets,r.length===1&&r[0]==="body")return document.body.replaceWith(t.body);let o=r.join(","),n=document.body.querySelectorAll(o),s=t.body.querySelectorAll(o);n.forEach((f,N)=>{if(!!f.matches(r[N])&&!!v("render",f,s[N])&&(f.replaceWith(s[N]),e.attrs.append||e.attrs.prepend)){let x=document.createElement("div");return t.childNodes.forEach(x.appendChild),e.attrs.append?f.appendChild(x):f.insertBefore(x,f.firstChild)}}),Or(t.body)}function Hr(e,t){let r=e.attrs.hydrate.join(","),o=document.body.querySelectorAll(r);if(o.length>0){let n=t.body.querySelectorAll(r);o.forEach((s,f)=>{!v("hydrate",s,n[f])||!n[f]||(s.firstChild.nodeType===Node.TEXT_NODE?s.innerHTML=n[f].innerHTML:s.replaceWith(n[f]))})}e.type=2,$(e),Ve([e.key])}function O(e,t){Pe(),we(),ke();let r=q(b[e.uuid]);return e.title=document.title=r.title||"",e.type===3?Hr(e,r):(Nr(e,r),t||(e.key===e.rev?P.replace(e.location,e):P.push(e.location,e)),scrollTo(e.position.x,e.position.y)),Ar(r.head),Ht(),Ee(),Ie(),Le(),v("load",e),e}var Ke;function Te(e){return P.replace(P.location,e),P.location.state}function Ft(){let{state:e}=P.location;return!e||e===null?!1:"rev"in e?e.rev:!1}function Wt(){P.location.state===null&&(P.location.state=window.history.state||Te(null));let{state:e}=P.location;return e.position=_(),typeof e.location!="object"&&(e.location=Te(null)),P.replace(P.location,e),e}function Mr(r){return u(this,arguments,function*({key:e,state:t}){if(t.key!==Ke&&ye(Ke),console.log("POSTATE",t.key,w(t.key)),w(t.key))return O(t,!0);Ke=t.key,t.type=9;let o=yield g(t);return o?O(o,!0):location.assign(t.key)})}function $r({action:e,location:t}){if(console.log("LISTENER",e,t),e==="REPLACE")console.log("IS REPLACE",t);else if(e==="POP")return Mr(t)}var Xt;function zt(){l.history||(Xt=P.listen($r),l.history=!0)}function Kt(){!l.history||(Xt(),l.history=!1)}function Sr(e){return!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)}function Ut(e,t){return function r(o){return o.preventDefault(),e.removeEventListener("click",r,!1),Wt(),typeof t=="object"?O(t):typeof t=="string"?Re(t):location.assign(t)}}function te(e){if(!Sr(e))return;let t=oe(e.target,p.href);if(!t)return;let r=h(t,2);!v("visit",e,r)||(w(r.key)?t.addEventListener("click",Ut(t,$(r)),!1):(jt(r.key),g(y(r)),t.addEventListener("click",Ut(t,r.key),!1)))}function Re(e,t=!1){return u(this,null,function*(){if(t){typeof t.attrs.cache=="string"&&!("hydrate"in t.attrs)&&(t.attrs.cache==="clear"?B():B(t.key));let r=yield g(t);if(r)return O(r)}else{if(yield Xe(e))return O(d[e]);ye(e)}return location.assign(e)})}function Jt(){l.hrefs||(A?addEventListener("pointerdown",te,!1):(addEventListener("mousedown",te,!1),addEventListener("touchstart",te,!1)),l.hrefs=!0)}function Gt(){!l.hrefs||(A?removeEventListener("pointerdown",te,!1):(removeEventListener("mousedown",te,!1),removeEventListener("touchstart",te,!1)),l.hrefs=!1)}function Zt(){let e=y(h(1)),t=Ft(),r=he(e,document.documentElement.outerHTML);i.reverse&&typeof t=="string"&&(e.rev=t),e.position=_(),v("connected",r),i.preload!==null&&(pe(i.preload)?L(o=>u(this,null,function*(){let n=h(o,7);n.key!==o&&(yield g(y(n)))}),i.preload):typeof i.preload=="object"&&e.key in i.preload&&L(o=>u(this,null,function*(){let n=h(o,7);n.key!==o&&(yield g(y(n)))}),i.preload[e.key])),Te(r),r.rev!==r.key&&g(y(h(r.rev,8))),removeEventListener("load",Zt)}function er(){zt(),Lt(),Jt(),Ee(),Ie(),Le(),addEventListener("load",Zt),console.info("@brixtol/pjax: Connection Established \u26A1")}function tr(){Kt(),kt(),Gt(),Pe(),we(),ke(),B(),console.warn("@brixtol/pjax: Instance has been disconnected! \u{1F614}")}var qr=!!(window.history.pushState&&window.requestAnimationFrame&&window.addEventListener&&window.DOMParser);function Nn(e={}){Me(e),qr?/https?/.test(window.location.protocol)?addEventListener("DOMContentLoaded",er):console.error("@brixtol/pjax: Invalid protocol, pjax expects https or http protocol"):console.error("@brixtol/pjax: Not supported by this browser")}function Hn(e,t){if(e)if(t)e==="config"&&Me(t),e==="observers"&&I(l,t);else{if(e==="config")return i;if(e==="observers")return l;if(e==="pages")return d;if(e==="snapshots")return b}let r=a(null);return r.config=i,r.snapshots=b,r.pages=d,r.observers=l,r}function Mn(e,t){return u(this,null,function*(){if(e===void 0)return De();if(typeof e=="string"){let r=se(e);if(!w(r))return console.info(`@brixtol/pjax: No store exists at: ${r}`);let o=De(r);return t!==void 0?$(I(o.page,t)):o}if(typeof e=="object")return $(e)})}function $n(e){return u(this,null,function*(){let t=d[ie];e&&I(t,e),t.type=10;let r=yield g(t);return r?(console.info("@brixtol/pjax: Triggered reload, page was re-cached"),O(r)):(console.warn("@brixtol/pjax: Reload failed, triggering refresh (cache will be purged)"),location.assign(t.key))})}function Sn(e){return u(this,null,function*(){let t=h(e,13);if(t.location.origin!==me)return console.error("@brixtol/pjax: Cross origin fetches are not allowed");let r=yield ge(t.key);if(r)return q(r)})}function jn(e){return B(e)}function qn(e){return u(this,null,function*(){})}function Cn(e,t){return u(this,null,function*(){let r=h(3);r.position=_(),r.attrs.hydrate=t;let o=yield ge(e);if(!o)return console.warn("@brixtol/pjax: hydration failed");let n=w(r.key)?$(r,o):y(r);if(i.reverse){let s=h(r.rev,8);g(s)}return O(n)})}function Dn(e){return u(this,null,function*(){let t=h(e,11);if(w(t.key)){console.warn(`@brixtol/pjax: Cache already exists for ${t.key}, prefetch skipped`);return}let r=yield g(y(t));if(r)return r;console.warn(`@brixtol/pjax: Prefetch failed for ${t.key}`)})}function Vn(e,t){return u(this,null,function*(){let r=h(e),o=typeof t=="object"?I(r,t):r;return w(r.key)?Re(r.key,$(o)):Re(r.key,y(o))})}function _n(){tr()}export{jn as clear,Nn as connect,_n as disconnect,Sn as fetch,Cn as hydrate,lr as off,cr as on,Dn as prefetch,$n as reload,Hn as session,Mn as state,qr as supported,qn as update,Vn as visit};
